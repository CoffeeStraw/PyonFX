
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="PyonFX documentation.
">
      
      
        <meta name="author" content="CoffeeStraw">
      
      
      
        <link rel="prev" href="../shape/">
      
      
      
      <link rel="icon" href="../../static/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>utils - PyonFX</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#utils" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="PyonFX" class="md-header__button md-logo" aria-label="PyonFX" data-md-component="logo">
      
  <img src="../../static/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PyonFX
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              utils
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/CoffeeStraw/PyonFX" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    CoffeeStraw/PyonFX
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="PyonFX" class="md-nav__button md-logo" aria-label="PyonFX" data-md-component="logo">
      
  <img src="../../static/logo.png" alt="logo">

    </a>
    PyonFX
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/CoffeeStraw/PyonFX" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    CoffeeStraw/PyonFX
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/installing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Install & Set-up
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    First Steps
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            First Steps
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/0-first-steps/01-explore-ass-values/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exploring ASS values
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/0-first-steps/02-hello-world/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hello World
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/0-first-steps/03-time-and-space/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Timing & Positioning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/0-first-steps/04-text-segmentation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Text Segmentation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Beginner
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Beginner
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/1-beginner/01-first-kfx/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    First Karaoke Effect
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/1-beginner/02-first-kfx-organized/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Organizing Your First KFX
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/1-beginner/03-romaji-kanji-translation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Romaji, Kanji & Translation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Intermediate
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Intermediate
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/2-intermediate/01-variations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Variations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/2-intermediate/02-shapes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Shapes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/3-advanced/01-frame-by-frame/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Frame-by-Frame
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/404" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TBD
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Module index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ass_core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ass_core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../convert/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    convert
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pixel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pixel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shape/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    shape
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pyonfx.utils" class="md-nav__link">
    <span class="md-ellipsis">
      utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyonfx.utils.Utils" class="md-nav__link">
    <span class="md-ellipsis">
      Utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.Utils.progress_bar" class="md-nav__link">
    <span class="md-ellipsis">
      progress_bar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.Utils.all_non_empty" class="md-nav__link">
    <span class="md-ellipsis">
      all_non_empty
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.Utils.accelerate" class="md-nav__link">
    <span class="md-ellipsis">
      accelerate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.Utils.interpolate" class="md-nav__link">
    <span class="md-ellipsis">
      interpolate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.Utils.retime" class="md-nav__link">
    <span class="md-ellipsis">
      retime
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyonfx.utils.FrameUtility" class="md-nav__link">
    <span class="md-ellipsis">
      FrameUtility
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FrameUtility">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.FrameUtility.duration" class="md-nav__link">
    <span class="md-ellipsis">
      duration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.FrameUtility.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.FrameUtility.reset" class="md-nav__link">
    <span class="md-ellipsis">
      reset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.FrameUtility.add" class="md-nav__link">
    <span class="md-ellipsis">
      add
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.FrameUtility.interpolate" class="md-nav__link">
    <span class="md-ellipsis">
      interpolate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyonfx.utils.ColorUtility" class="md-nav__link">
    <span class="md-ellipsis">
      ColorUtility
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ColorUtility">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.ColorUtility.get_color_change" class="md-nav__link">
    <span class="md-ellipsis">
      get_color_change
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.ColorUtility.get_fr_color_change" class="md-nav__link">
    <span class="md-ellipsis">
      get_fr_color_change
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Explanation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Explanation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/404" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TBD
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pyonfx.utils" class="md-nav__link">
    <span class="md-ellipsis">
      utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyonfx.utils.Utils" class="md-nav__link">
    <span class="md-ellipsis">
      Utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.Utils.progress_bar" class="md-nav__link">
    <span class="md-ellipsis">
      progress_bar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.Utils.all_non_empty" class="md-nav__link">
    <span class="md-ellipsis">
      all_non_empty
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.Utils.accelerate" class="md-nav__link">
    <span class="md-ellipsis">
      accelerate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.Utils.interpolate" class="md-nav__link">
    <span class="md-ellipsis">
      interpolate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.Utils.retime" class="md-nav__link">
    <span class="md-ellipsis">
      retime
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyonfx.utils.FrameUtility" class="md-nav__link">
    <span class="md-ellipsis">
      FrameUtility
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FrameUtility">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.FrameUtility.duration" class="md-nav__link">
    <span class="md-ellipsis">
      duration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.FrameUtility.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.FrameUtility.reset" class="md-nav__link">
    <span class="md-ellipsis">
      reset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.FrameUtility.add" class="md-nav__link">
    <span class="md-ellipsis">
      add
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.FrameUtility.interpolate" class="md-nav__link">
    <span class="md-ellipsis">
      interpolate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyonfx.utils.ColorUtility" class="md-nav__link">
    <span class="md-ellipsis">
      ColorUtility
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ColorUtility">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.ColorUtility.get_color_change" class="md-nav__link">
    <span class="md-ellipsis">
      get_color_change
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyonfx.utils.ColorUtility.get_fr_color_change" class="md-nav__link">
    <span class="md-ellipsis">
      get_fr_color_change
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="utils">Utils</h1>


<div class="doc doc-object doc-module">



<a id="pyonfx.utils"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="pyonfx.utils.Utils" class="doc doc-heading">
            <code>Utils</code>


</h2>


    <div class="doc doc-contents ">


        <p>This class is a collection of static methods that will help the user in some tasks.</p>







              <details class="quote">
                <summary>Source code in <code>pyonfx/utils.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Utils</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class is a collection of static methods that will help the user in some tasks.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_LineWordSyllableChar</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_LineWordSyllableChar&quot;</span><span class="p">,</span> <span class="n">Line</span><span class="p">,</span> <span class="n">Word</span><span class="p">,</span> <span class="n">Syllable</span><span class="p">,</span> <span class="n">Char</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">progress_bar</span><span class="p">(</span>
        <span class="n">iterable</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">_LineWordSyllableChar</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">_LineWordSyllableChar</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wrap an iterable of [`Line`][pyonfx.ass_core.Line], [`Word`][pyonfx.ass_core.Word], [`Syllable`][pyonfx.ass_core.Syllable], or [`Char`][pyonfx.ass_core.Char] with a tqdm progress bar.</span>

<span class="sd">        Args:</span>
<span class="sd">            iterable: An iterable containing elements of type [`Line`][pyonfx.ass_core.Line], [`Word`][pyonfx.ass_core.Word], [`Syllable`][pyonfx.ass_core.Syllable], or [`Char`][pyonfx.ass_core.Char].</span>
<span class="sd">            **kwargs: Additional arguments passed to the tqdm progress bar.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Iterable[_LineWordSyllableChar]: An iterator wrapping the original iterable with a tqdm</span>
<span class="sd">            progress bar displaying the iteration progress.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; items = [line1, line2, line3]</span>
<span class="sd">            &gt;&gt;&gt; for item in Utils.progress_bar(items):</span>
<span class="sd">            ...     process(item)</span>

<span class="sd">        See Also:</span>
<span class="sd">            [`all_non_empty`][pyonfx.utils.Utils.all_non_empty]: Which also uses `progress_bar` for optionally wrapping its returned iterable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Convert to list to support multiple passes and len()</span>
        <span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">items</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">iter</span><span class="p">([])</span>

        <span class="n">first</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">obj_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">first</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">obj_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="s2">&quot;word&quot;</span><span class="p">,</span> <span class="s2">&quot;syllable&quot;</span><span class="p">,</span> <span class="s2">&quot;char&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;with_progress only supports Line, Word, Syllable, or Char (got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">first</span><span class="p">)</span><span class="si">}</span><span class="s2">).&quot;</span>
            <span class="p">)</span>
        <span class="n">emoji</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;line&quot;</span><span class="p">:</span> <span class="s2">&quot;🐰&quot;</span><span class="p">,</span>
            <span class="s2">&quot;word&quot;</span><span class="p">:</span> <span class="s2">&quot;🔤&quot;</span><span class="p">,</span>
            <span class="s2">&quot;syllable&quot;</span><span class="p">:</span> <span class="s2">&quot;🎤&quot;</span><span class="p">,</span>
            <span class="s2">&quot;char&quot;</span><span class="p">:</span> <span class="s2">&quot;🔠&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">tqdm</span><span class="p">(</span>
            <span class="n">items</span><span class="p">,</span>
            <span class="n">desc</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;desc&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Processed </span><span class="si">{</span><span class="n">obj_name</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">),</span>
            <span class="n">unit</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;unit&quot;</span><span class="p">,</span> <span class="n">obj_name</span><span class="p">),</span>
            <span class="n">leave</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;leave&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
            <span class="n">ascii</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">,</span> <span class="s2">&quot; ▖▘▝▗▚▞█&quot;</span><span class="p">),</span>
            <span class="n">bar_format</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span>
                <span class="s2">&quot;bar_format&quot;</span><span class="p">,</span>
                <span class="n">emoji</span><span class="p">[</span><span class="n">obj_name</span><span class="p">]</span>
                <span class="o">+</span> <span class="s2">&quot; </span><span class="si">{desc}</span><span class="s2">: |</span><span class="si">{bar}</span><span class="s2">| </span><span class="si">{percentage:3.0f}</span><span class="s2">% [</span><span class="si">{n_fmt}</span><span class="s2">/</span><span class="si">{total_fmt}</span><span class="s2">] &quot;</span>
                <span class="s2">&quot;⏱️  </span><span class="si">{elapsed}</span><span class="s2">&lt;</span><span class="si">{remaining}</span><span class="s2">, </span><span class="si">{rate_fmt}{postfix}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">all_non_empty</span><span class="p">(</span>
        <span class="n">lines_words_syls_or_chars</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">_LineWordSyllableChar</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">filter_comment</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">filter_whitespace_text</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">filter_empty_duration</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">renumber_indexes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">progress_bar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">_LineWordSyllableChar</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter and return non-empty elements from a given iterable.</span>

<span class="sd">        Args:</span>
<span class="sd">            lines_words_syls_or_chars: An iterable containing elements of type [`Line`][pyonfx.ass_core.Line], [`Word`][pyonfx.ass_core.Word], [`Syllable`][pyonfx.ass_core.Syllable], or [`Char`][pyonfx.ass_core.Char].</span>
<span class="sd">            filter_comment: If True, filters out objects with comments (only applicable for [`Line`][pyonfx.ass_core.Line] objects).</span>
<span class="sd">            filter_whitespace_text: If True, filters out objects whose text attribute is empty or contains only whitespace.</span>
<span class="sd">            filter_empty_duration: If True, filters out objects with a duration less than or equal to zero.</span>
<span class="sd">            renumber_indexes: If True, reassigns indexes (`i`, `word_i`, `syl_i`) of the filtered objects.</span>
<span class="sd">            progress_bar: If True, wraps the resulting iterable with a progress bar for visual feedback.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Iterable[_LineWordSyllableChar]: An iterator that yields the filtered objects after applying all criteria.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; for item in Utils.all_non_empty(lines):</span>
<span class="sd">            ...     print(item.text)</span>

<span class="sd">        See Also:</span>
<span class="sd">            [`progress_bar`][pyonfx.utils.Utils.progress_bar]: Used to wrap the iterable with a progress indicator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Utils</span><span class="o">.</span><span class="n">_LineWordSyllableChar</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">lines_words_syls_or_chars</span><span class="p">:</span>
            <span class="n">empty_for_text</span> <span class="o">=</span> <span class="n">filter_whitespace_text</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">obj</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">empty_for_duration</span> <span class="o">=</span> <span class="n">filter_empty_duration</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">duration</span> <span class="o">&lt;=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">empty_for_text</span> <span class="ow">or</span> <span class="n">empty_for_duration</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">filter_comment</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Line</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">comment</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">renumber_indexes</span><span class="p">:</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">_renumber_attr</span><span class="p">(</span><span class="n">attr_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">out</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">attr_name</span><span class="p">):</span>
                    <span class="k">return</span>

                <span class="n">first_seen</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">next_idx</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">out</span><span class="p">:</span>
                    <span class="n">old_val</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">old_val</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">first_seen</span><span class="p">:</span>
                        <span class="n">first_seen</span><span class="p">[</span><span class="n">old_val</span><span class="p">]</span> <span class="o">=</span> <span class="n">next_idx</span>
                        <span class="n">next_idx</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">first_seen</span><span class="p">[</span><span class="n">old_val</span><span class="p">])</span>

            <span class="k">for</span> <span class="n">secondary</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;i&quot;</span><span class="p">,</span> <span class="s2">&quot;word_i&quot;</span><span class="p">,</span> <span class="s2">&quot;syl_i&quot;</span><span class="p">):</span>
                <span class="n">_renumber_attr</span><span class="p">(</span><span class="n">secondary</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">progress_bar</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Utils</span><span class="o">.</span><span class="n">progress_bar</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">accelerate</span><span class="p">(</span>
        <span class="n">pct</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">acc</span><span class="p">:</span> <span class="p">(</span>
            <span class="nb">float</span>
            <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span>
                <span class="s2">&quot;in_back&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_back&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_back&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_bounce&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_bounce&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_bounce&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_circ&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_circ&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_circ&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_cubic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_cubic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_cubic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_elastic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_elastic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_elastic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_expo&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_expo&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_expo&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_quad&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_quad&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_quad&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_quart&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_quart&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_quart&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_quint&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_quint&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_quint&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_sine&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_sine&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_sine&quot;</span><span class="p">,</span>
            <span class="p">]</span>
            <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span>
        <span class="p">)</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Transform a progress percentage using an acceleration function.</span>

<span class="sd">        Args:</span>
<span class="sd">            pct: A float representing the progress percentage, typically between 0.0 and 1.0.</span>
<span class="sd">            acc: A float, string, or callable defining the acceleration function. Defaults to 1.0 for linear progression.</span>
<span class="sd">                 - If a float is provided, it acts as the exponent for the transformation.</span>
<span class="sd">                 - If a string is provided, it must correspond to a preset easing function name as defined in `rpeasings`.</span>
<span class="sd">                 - If a callable is provided, it should accept a float and return a transformed float.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: The transformed percentage value after applying the acceleration function.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; Utils.accelerate(0.5, 2.0)</span>
<span class="sd">            0.25</span>
<span class="sd">            &gt;&gt;&gt; Utils.accelerate(0.5, &quot;in_expo&quot;)</span>
<span class="sd">            0.3125</span>

<span class="sd">        Notes:</span>
<span class="sd">            Refer to [https://easings.net/](https://easings.net/) for guidance in choosing among the available easing functions.</span>

<span class="sd">        See Also:</span>
<span class="sd">            [`interpolate`][pyonfx.utils.Utils.interpolate]: Used for interpolating between values with easing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">pct</span> <span class="o">==</span> <span class="mf">0.0</span> <span class="ow">or</span> <span class="n">pct</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pct</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="n">fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="n">acc</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fn</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">rpeasings</span><span class="p">,</span> <span class="n">acc</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown easing function: </span><span class="si">{</span><span class="n">acc</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">acc</span><span class="p">):</span>
            <span class="n">fn</span> <span class="o">=</span> <span class="n">acc</span>  <span class="c1"># Assume it follows the Accelerator protocol</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Accelerator must be float, str, or callable&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="n">pct</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">interpolate</span><span class="p">(</span>
        <span class="n">pct</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">val1</span><span class="p">:</span> <span class="n">_FloatStr</span><span class="p">,</span>
        <span class="n">val2</span><span class="p">:</span> <span class="n">_FloatStr</span><span class="p">,</span>
        <span class="n">acc</span><span class="p">:</span> <span class="p">(</span>
            <span class="nb">float</span>
            <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span>
                <span class="s2">&quot;in_back&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_back&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_back&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_bounce&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_bounce&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_bounce&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_circ&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_circ&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_circ&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_cubic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_cubic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_cubic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_elastic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_elastic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_elastic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_expo&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_expo&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_expo&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_quad&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_quad&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_quad&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_quart&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_quart&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_quart&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_quint&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_quint&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_quint&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_sine&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_sine&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_sine&quot;</span><span class="p">,</span>
            <span class="p">]</span>
            <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span>
        <span class="p">)</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_FloatStr</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Interpolate between two values with an optional acceleration (easing) function.</span>

<span class="sd">        Args:</span>
<span class="sd">            pct: A float in the range [0.0, 1.0] representing the interpolation factor.</span>
<span class="sd">            val1: The starting value (ASS color, ASS alpha channel or number) for interpolation.</span>
<span class="sd">            val2: The ending value (ASS color, ASS alpha channel or number) for interpolation.</span>
<span class="sd">            acc: A float, string, or callable defining the acceleration function. Defaults to 1.0 for linear progression.</span>
<span class="sd">                 - If a float is provided, it acts as the exponent for the transformation.</span>
<span class="sd">                 - If a string is provided, it must correspond to a preset easing function name as defined in `rpeasings`.</span>
<span class="sd">                 - If a callable is provided, it should accept a float and return a transformed float.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The interpolated value, either a number or a string, matching the type of `val1` and `val2`.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; Utils.interpolate(0.5, 10, 20)</span>
<span class="sd">            15.0</span>
<span class="sd">            &gt;&gt;&gt; Utils.interpolate(0.9, &quot;&amp;HFFFFFF&amp;&quot;, &quot;&amp;H000000&amp;&quot;)</span>
<span class="sd">            &amp;HE5E5E5&amp;</span>
<span class="sd">            &gt;&gt;&gt; Utils.interpolate(0.5, 10, 20, &quot;ease-in&quot;)</span>
<span class="sd">            13.05</span>
<span class="sd">            &gt;&gt;&gt; Utils.interpolate(0.5, 10, 20, 2.0)</span>
<span class="sd">            12.5</span>

<span class="sd">        Notes:</span>
<span class="sd">            Refer to [https://easings.net/](https://easings.net/) for guidance in choosing among the available easing functions.</span>

<span class="sd">        See Also:</span>
<span class="sd">            [`accelerate`][pyonfx.utils.Utils.accelerate]: Used to transform percentage values with easing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">pct</span> <span class="o">&gt;</span> <span class="mf">1.0</span> <span class="ow">or</span> <span class="n">pct</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Percent value must be a float between 0.0 and 1.0, but yours was </span><span class="si">{</span><span class="n">pct</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Apply acceleration function</span>
        <span class="n">pct</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">.</span><span class="n">accelerate</span><span class="p">(</span><span class="n">pct</span><span class="p">,</span> <span class="n">acc</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">interpolate_numbers</span><span class="p">(</span><span class="n">val1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">val2</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
            <span class="k">nonlocal</span> <span class="n">pct</span>
            <span class="k">return</span> <span class="n">val1</span> <span class="o">+</span> <span class="p">(</span><span class="n">val2</span> <span class="o">-</span> <span class="n">val1</span><span class="p">)</span> <span class="o">*</span> <span class="n">pct</span>

        <span class="c1"># Interpolating</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val1</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val2</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">val1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">val2</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;ASS values must have the same type (either two alphas, two colors or two colors+alpha).&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">val1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="s2">&quot;&amp;HXX&amp;&quot;</span><span class="p">):</span>
                <span class="n">val1_dec</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">alpha_ass_to_dec</span><span class="p">(</span><span class="n">val1</span><span class="p">)</span>
                <span class="n">val2_dec</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">alpha_ass_to_dec</span><span class="p">(</span><span class="n">val2</span><span class="p">)</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">interpolate_numbers</span><span class="p">(</span><span class="n">val1_dec</span><span class="p">,</span> <span class="n">val2_dec</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">Convert</span><span class="o">.</span><span class="n">alpha_dec_to_ass</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">val1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="s2">&quot;&amp;HBBGGRR&amp;&quot;</span><span class="p">):</span>
                <span class="n">val1_rgb</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">color_ass_to_rgb</span><span class="p">(</span><span class="n">val1</span><span class="p">)</span>
                <span class="n">val2_rgb</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">color_ass_to_rgb</span><span class="p">(</span><span class="n">val2</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val1_rgb</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val2_rgb</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="n">rgb</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                        <span class="nb">int</span><span class="p">(</span><span class="n">interpolate_numbers</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">))</span>
                        <span class="k">for</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">val1_rgb</span><span class="p">,</span> <span class="n">val2_rgb</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rgb</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">Convert</span><span class="o">.</span><span class="n">color_rgb_to_ass</span><span class="p">(</span><span class="n">rgb</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid RGB color conversion&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">val1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="s2">&quot;&amp;HAABBGGRR&quot;</span><span class="p">):</span>
                <span class="n">val1_rgba</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">val1</span><span class="p">,</span> <span class="n">ColorModel</span><span class="o">.</span><span class="n">ASS</span><span class="p">,</span> <span class="n">ColorModel</span><span class="o">.</span><span class="n">RGBA</span><span class="p">)</span>
                <span class="n">val2_rgba</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">val2</span><span class="p">,</span> <span class="n">ColorModel</span><span class="o">.</span><span class="n">ASS</span><span class="p">,</span> <span class="n">ColorModel</span><span class="o">.</span><span class="n">RGBA</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val1_rgba</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val2_rgba</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="n">rgba</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                        <span class="n">interpolate_numbers</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">val1_rgba</span><span class="p">,</span> <span class="n">val2_rgba</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rgba</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                        <span class="n">result</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">rgba</span><span class="p">,</span> <span class="n">ColorModel</span><span class="o">.</span><span class="n">RGBA</span><span class="p">,</span> <span class="n">ColorModel</span><span class="o">.</span><span class="n">ASS</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                            <span class="k">return</span> <span class="n">result</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid RGBA color conversion&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Provided inputs &#39;</span><span class="si">{</span><span class="n">val1</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="n">val2</span><span class="si">}</span><span class="s2">&#39; are not valid ASS strings.&quot;</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val1</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val2</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">interpolate_numbers</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val1</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">val2</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;Invalid input(s) type, either pass two strings or two numbers.&quot;</span>
            <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">retime</span><span class="p">(</span>
        <span class="n">mode</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span>
            <span class="s2">&quot;syl&quot;</span><span class="p">,</span>
            <span class="s2">&quot;presyl&quot;</span><span class="p">,</span>
            <span class="s2">&quot;postsyl&quot;</span><span class="p">,</span>
            <span class="s2">&quot;line&quot;</span><span class="p">,</span>
            <span class="s2">&quot;preline&quot;</span><span class="p">,</span>
            <span class="s2">&quot;postline&quot;</span><span class="p">,</span>
            <span class="s2">&quot;start2syl&quot;</span><span class="p">,</span>
            <span class="s2">&quot;syl2end&quot;</span><span class="p">,</span>
            <span class="s2">&quot;set&quot;</span><span class="p">,</span>
            <span class="s2">&quot;abs&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sylpct&quot;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="n">output_line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span>
        <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span>
        <span class="n">word_syl_or_char</span><span class="p">:</span> <span class="n">Word</span> <span class="o">|</span> <span class="n">Syllable</span> <span class="o">|</span> <span class="n">Char</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">offset_start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">offset_end</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adjust the timing of a subtitle line based on a specified mode.</span>

<span class="sd">        Args:</span>
<span class="sd">            mode: A string literal indicating the retime mode. Each mode applies a different timing adjustment strategy.</span>
<span class="sd">            output_line: The subtitle line object whose `start_time` and `end_time` will be adjusted.</span>
<span class="sd">            line: The subtitle line object whose `start_time` and `end_time` will be used as reference.</span>
<span class="sd">            word_syl_or_char: An optional element ([`Word`][pyonfx.ass_core.Word], [`Syllable`][pyonfx.ass_core.Syllable], or [`Char`][pyonfx.ass_core.Char])</span>
<span class="sd">                              providing timing reference for modes that require relative timing. Must be provided for modes other than</span>
<span class="sd">                              &quot;line&quot;, &quot;preline&quot;, &quot;postline&quot;, &quot;set&quot;, and &quot;abs&quot;.</span>
<span class="sd">            offset_start: An optional integer offset (in milliseconds) to add to the computed start time.</span>
<span class="sd">            offset_end: An optional integer offset (in milliseconds) to add to the computed end time.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; # Retiming a line based on the timing of a syllable</span>
<span class="sd">            &gt;&gt;&gt; Utils.retime(&quot;syl&quot;, l, line, syl, offset_start=10, offset_end=5)</span>
<span class="sd">            &gt;&gt;&gt; # Retiming a line to keep its original timing (no adjustment)</span>
<span class="sd">            &gt;&gt;&gt; Utils.retime(&quot;line&quot;, l, line)</span>

<span class="sd">        See Also:</span>
<span class="sd">            [kara-templater retime implementation](https://github.com/slackingway/karaOK/blob/master/autoload/ln.kara-templater-mod.lua#L352)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;syl&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">word_syl_or_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;word_syl_or_char must be provided for mode &#39;syl&#39;&quot;</span><span class="p">)</span>
            <span class="n">new_start</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">start_time</span>
            <span class="n">new_end</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">end_time</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;presyl&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">word_syl_or_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;word_syl_or_char must be provided for mode &#39;presyl&#39;&quot;</span><span class="p">)</span>
            <span class="n">new_start</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">start_time</span>
            <span class="n">new_end</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">start_time</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;postsyl&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">word_syl_or_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;word_syl_or_char must be provided for mode &#39;postsyl&#39;&quot;</span><span class="p">)</span>
            <span class="n">new_start</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">end_time</span>
            <span class="n">new_end</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">end_time</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;line&quot;</span><span class="p">:</span>
            <span class="n">new_start</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span>
            <span class="n">new_end</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">end_time</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;preline&quot;</span><span class="p">:</span>
            <span class="n">new_start</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span>
            <span class="n">new_end</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;postline&quot;</span><span class="p">:</span>
            <span class="n">new_start</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">end_time</span>
            <span class="n">new_end</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">end_time</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;start2syl&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">word_syl_or_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;word_syl_or_char must be provided for mode &#39;start2syl&#39;&quot;</span>
                <span class="p">)</span>
            <span class="n">new_start</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span>
            <span class="n">new_end</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">start_time</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;syl2end&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">word_syl_or_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;word_syl_or_char must be provided for mode &#39;syl2end&#39;&quot;</span><span class="p">)</span>
            <span class="n">new_start</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">end_time</span>
            <span class="n">new_end</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">end_time</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;set&quot;</span><span class="p">,</span> <span class="s2">&quot;abs&quot;</span><span class="p">):</span>
            <span class="n">new_start</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">new_end</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;sylpct&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">word_syl_or_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;word_syl_or_char must be provided for mode &#39;sylpct&#39;&quot;</span><span class="p">)</span>
            <span class="n">new_start</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">line</span><span class="o">.</span><span class="n">start_time</span>
                <span class="o">+</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">start_time</span>
                <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">offset_start</span> <span class="o">*</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">duration</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">new_end</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">line</span><span class="o">.</span><span class="n">start_time</span>
                <span class="o">+</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">start_time</span>
                <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">offset_end</span> <span class="o">*</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">duration</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown retime mode: </span><span class="si">{</span><span class="n">mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">mode</span> <span class="o">!=</span> <span class="s2">&quot;sylpct&quot;</span><span class="p">:</span>
            <span class="n">new_start</span> <span class="o">+=</span> <span class="n">offset_start</span>
            <span class="n">new_end</span> <span class="o">+=</span> <span class="n">offset_end</span>

        <span class="n">output_line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">new_start</span>
        <span class="n">output_line</span><span class="o">.</span><span class="n">end_time</span> <span class="o">=</span> <span class="n">new_end</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pyonfx.utils.Utils.progress_bar" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">progress_bar</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Wrap an iterable of <a class="autorefs autorefs-internal" title="Line


  
      dataclass
  " href="../ass_core/#pyonfx.ass_core.Line"><code>Line</code></a>, <a class="autorefs autorefs-internal" title="Word


  
      dataclass
  " href="../ass_core/#pyonfx.ass_core.Word"><code>Word</code></a>, <a class="autorefs autorefs-internal" title="Syllable


  
      dataclass
  " href="../ass_core/#pyonfx.ass_core.Syllable"><code>Syllable</code></a>, or <a class="autorefs autorefs-internal" title="Char


  
      dataclass
  " href="../ass_core/#pyonfx.ass_core.Char"><code>Char</code></a> with a tqdm progress bar.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>iterable</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[<span title="pyonfx.utils.Utils._LineWordSyllableChar">_LineWordSyllableChar</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An iterable containing elements of type <a class="autorefs autorefs-internal" title="Line


  
      dataclass
  " href="../ass_core/#pyonfx.ass_core.Line"><code>Line</code></a>, <a class="autorefs autorefs-internal" title="Word


  
      dataclass
  " href="../ass_core/#pyonfx.ass_core.Word"><code>Word</code></a>, <a class="autorefs autorefs-internal" title="Syllable


  
      dataclass
  " href="../ass_core/#pyonfx.ass_core.Syllable"><code>Syllable</code></a>, or <a class="autorefs autorefs-internal" title="Char


  
      dataclass
  " href="../ass_core/#pyonfx.ass_core.Char"><code>Char</code></a>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments passed to the tqdm progress bar.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[<span title="pyonfx.utils.Utils._LineWordSyllableChar">_LineWordSyllableChar</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Iterable[_LineWordSyllableChar]: An iterator wrapping the original iterable with a tqdm</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[<span title="pyonfx.utils.Utils._LineWordSyllableChar">_LineWordSyllableChar</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>progress bar displaying the iteration progress.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">,</span> <span class="n">line3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">Utils</span><span class="o">.</span><span class="n">progress_bar</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">process</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</code></pre></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <p><a class="autorefs autorefs-internal" title="all_non_empty(lines_words_syls_or_chars, *, filter_comment=True, filter_whitespace_text=True, filter_empty_duration=False, renumber_indexes=True, progress_bar=True)

  
      staticmethod
  " href="#pyonfx.utils.Utils.all_non_empty"><code>all_non_empty</code></a>: Which also uses <code>progress_bar</code> for optionally wrapping its returned iterable.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>pyonfx/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">progress_bar</span><span class="p">(</span>
    <span class="n">iterable</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">_LineWordSyllableChar</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">_LineWordSyllableChar</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrap an iterable of [`Line`][pyonfx.ass_core.Line], [`Word`][pyonfx.ass_core.Word], [`Syllable`][pyonfx.ass_core.Syllable], or [`Char`][pyonfx.ass_core.Char] with a tqdm progress bar.</span>

<span class="sd">    Args:</span>
<span class="sd">        iterable: An iterable containing elements of type [`Line`][pyonfx.ass_core.Line], [`Word`][pyonfx.ass_core.Word], [`Syllable`][pyonfx.ass_core.Syllable], or [`Char`][pyonfx.ass_core.Char].</span>
<span class="sd">        **kwargs: Additional arguments passed to the tqdm progress bar.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Iterable[_LineWordSyllableChar]: An iterator wrapping the original iterable with a tqdm</span>
<span class="sd">        progress bar displaying the iteration progress.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; items = [line1, line2, line3]</span>
<span class="sd">        &gt;&gt;&gt; for item in Utils.progress_bar(items):</span>
<span class="sd">        ...     process(item)</span>

<span class="sd">    See Also:</span>
<span class="sd">        [`all_non_empty`][pyonfx.utils.Utils.all_non_empty]: Which also uses `progress_bar` for optionally wrapping its returned iterable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert to list to support multiple passes and len()</span>
    <span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">items</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">([])</span>

    <span class="n">first</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">obj_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">first</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">obj_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="s2">&quot;word&quot;</span><span class="p">,</span> <span class="s2">&quot;syllable&quot;</span><span class="p">,</span> <span class="s2">&quot;char&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;with_progress only supports Line, Word, Syllable, or Char (got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">first</span><span class="p">)</span><span class="si">}</span><span class="s2">).&quot;</span>
        <span class="p">)</span>
    <span class="n">emoji</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;line&quot;</span><span class="p">:</span> <span class="s2">&quot;🐰&quot;</span><span class="p">,</span>
        <span class="s2">&quot;word&quot;</span><span class="p">:</span> <span class="s2">&quot;🔤&quot;</span><span class="p">,</span>
        <span class="s2">&quot;syllable&quot;</span><span class="p">:</span> <span class="s2">&quot;🎤&quot;</span><span class="p">,</span>
        <span class="s2">&quot;char&quot;</span><span class="p">:</span> <span class="s2">&quot;🔠&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">tqdm</span><span class="p">(</span>
        <span class="n">items</span><span class="p">,</span>
        <span class="n">desc</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;desc&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Processed </span><span class="si">{</span><span class="n">obj_name</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">),</span>
        <span class="n">unit</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;unit&quot;</span><span class="p">,</span> <span class="n">obj_name</span><span class="p">),</span>
        <span class="n">leave</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;leave&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">ascii</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">,</span> <span class="s2">&quot; ▖▘▝▗▚▞█&quot;</span><span class="p">),</span>
        <span class="n">bar_format</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span>
            <span class="s2">&quot;bar_format&quot;</span><span class="p">,</span>
            <span class="n">emoji</span><span class="p">[</span><span class="n">obj_name</span><span class="p">]</span>
            <span class="o">+</span> <span class="s2">&quot; </span><span class="si">{desc}</span><span class="s2">: |</span><span class="si">{bar}</span><span class="s2">| </span><span class="si">{percentage:3.0f}</span><span class="s2">% [</span><span class="si">{n_fmt}</span><span class="s2">/</span><span class="si">{total_fmt}</span><span class="s2">] &quot;</span>
            <span class="s2">&quot;⏱️  </span><span class="si">{elapsed}</span><span class="s2">&lt;</span><span class="si">{remaining}</span><span class="s2">, </span><span class="si">{rate_fmt}{postfix}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyonfx.utils.Utils.all_non_empty" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">all_non_empty</span><span class="p">(</span><span class="n">lines_words_syls_or_chars</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">filter_comment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">filter_whitespace_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">filter_empty_duration</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">renumber_indexes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Filter and return non-empty elements from a given iterable.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>lines_words_syls_or_chars</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[<span title="pyonfx.utils.Utils._LineWordSyllableChar">_LineWordSyllableChar</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An iterable containing elements of type <a class="autorefs autorefs-internal" title="Line


  
      dataclass
  " href="../ass_core/#pyonfx.ass_core.Line"><code>Line</code></a>, <a class="autorefs autorefs-internal" title="Word


  
      dataclass
  " href="../ass_core/#pyonfx.ass_core.Word"><code>Word</code></a>, <a class="autorefs autorefs-internal" title="Syllable


  
      dataclass
  " href="../ass_core/#pyonfx.ass_core.Syllable"><code>Syllable</code></a>, or <a class="autorefs autorefs-internal" title="Char


  
      dataclass
  " href="../ass_core/#pyonfx.ass_core.Char"><code>Char</code></a>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filter_comment</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, filters out objects with comments (only applicable for <a class="autorefs autorefs-internal" title="Line


  
      dataclass
  " href="../ass_core/#pyonfx.ass_core.Line"><code>Line</code></a> objects).</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filter_whitespace_text</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, filters out objects whose text attribute is empty or contains only whitespace.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filter_empty_duration</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, filters out objects with a duration less than or equal to zero.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>renumber_indexes</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, reassigns indexes (<code>i</code>, <code>word_i</code>, <code>syl_i</code>) of the filtered objects.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>progress_bar</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, wraps the resulting iterable with a progress bar for visual feedback.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[<span title="pyonfx.utils.Utils._LineWordSyllableChar">_LineWordSyllableChar</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Iterable[_LineWordSyllableChar]: An iterator that yields the filtered objects after applying all criteria.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">Utils</span><span class="o">.</span><span class="n">all_non_empty</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</code></pre></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <p><a class="autorefs autorefs-internal" title="progress_bar(iterable, **kwargs)

  
      staticmethod
  " href="#pyonfx.utils.Utils.progress_bar"><code>progress_bar</code></a>: Used to wrap the iterable with a progress indicator.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>pyonfx/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">all_non_empty</span><span class="p">(</span>
    <span class="n">lines_words_syls_or_chars</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">_LineWordSyllableChar</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">filter_comment</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">filter_whitespace_text</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">filter_empty_duration</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">renumber_indexes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">progress_bar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">_LineWordSyllableChar</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter and return non-empty elements from a given iterable.</span>

<span class="sd">    Args:</span>
<span class="sd">        lines_words_syls_or_chars: An iterable containing elements of type [`Line`][pyonfx.ass_core.Line], [`Word`][pyonfx.ass_core.Word], [`Syllable`][pyonfx.ass_core.Syllable], or [`Char`][pyonfx.ass_core.Char].</span>
<span class="sd">        filter_comment: If True, filters out objects with comments (only applicable for [`Line`][pyonfx.ass_core.Line] objects).</span>
<span class="sd">        filter_whitespace_text: If True, filters out objects whose text attribute is empty or contains only whitespace.</span>
<span class="sd">        filter_empty_duration: If True, filters out objects with a duration less than or equal to zero.</span>
<span class="sd">        renumber_indexes: If True, reassigns indexes (`i`, `word_i`, `syl_i`) of the filtered objects.</span>
<span class="sd">        progress_bar: If True, wraps the resulting iterable with a progress bar for visual feedback.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Iterable[_LineWordSyllableChar]: An iterator that yields the filtered objects after applying all criteria.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; for item in Utils.all_non_empty(lines):</span>
<span class="sd">        ...     print(item.text)</span>

<span class="sd">    See Also:</span>
<span class="sd">        [`progress_bar`][pyonfx.utils.Utils.progress_bar]: Used to wrap the iterable with a progress indicator.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">out</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Utils</span><span class="o">.</span><span class="n">_LineWordSyllableChar</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">lines_words_syls_or_chars</span><span class="p">:</span>
        <span class="n">empty_for_text</span> <span class="o">=</span> <span class="n">filter_whitespace_text</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">obj</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">empty_for_duration</span> <span class="o">=</span> <span class="n">filter_empty_duration</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">duration</span> <span class="o">&lt;=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">empty_for_text</span> <span class="ow">or</span> <span class="n">empty_for_duration</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">filter_comment</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Line</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">comment</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">renumber_indexes</span><span class="p">:</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_renumber_attr</span><span class="p">(</span><span class="n">attr_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">out</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">attr_name</span><span class="p">):</span>
                <span class="k">return</span>

            <span class="n">first_seen</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">next_idx</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">out</span><span class="p">:</span>
                <span class="n">old_val</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">old_val</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">first_seen</span><span class="p">:</span>
                    <span class="n">first_seen</span><span class="p">[</span><span class="n">old_val</span><span class="p">]</span> <span class="o">=</span> <span class="n">next_idx</span>
                    <span class="n">next_idx</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">first_seen</span><span class="p">[</span><span class="n">old_val</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">secondary</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;i&quot;</span><span class="p">,</span> <span class="s2">&quot;word_i&quot;</span><span class="p">,</span> <span class="s2">&quot;syl_i&quot;</span><span class="p">):</span>
            <span class="n">_renumber_attr</span><span class="p">(</span><span class="n">secondary</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">progress_bar</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Utils</span><span class="o">.</span><span class="n">progress_bar</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyonfx.utils.Utils.accelerate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">accelerate</span><span class="p">(</span><span class="n">pct</span><span class="p">,</span> <span class="n">acc</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Transform a progress percentage using an acceleration function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pct</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A float representing the progress percentage, typically between 0.0 and 1.0.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>acc</code>
            </td>
            <td>
                  <code><span title="float">float</span> | <span title="typing.Literal">Literal</span>[&#39;in_back&#39;, &#39;out_back&#39;, &#39;in_out_back&#39;, &#39;in_bounce&#39;, &#39;out_bounce&#39;, &#39;in_out_bounce&#39;, &#39;in_circ&#39;, &#39;out_circ&#39;, &#39;in_out_circ&#39;, &#39;in_cubic&#39;, &#39;out_cubic&#39;, &#39;in_out_cubic&#39;, &#39;in_elastic&#39;, &#39;out_elastic&#39;, &#39;in_out_elastic&#39;, &#39;in_expo&#39;, &#39;out_expo&#39;, &#39;in_out_expo&#39;, &#39;in_quad&#39;, &#39;out_quad&#39;, &#39;in_out_quad&#39;, &#39;in_quart&#39;, &#39;out_quart&#39;, &#39;in_out_quart&#39;, &#39;in_quint&#39;, &#39;out_quint&#39;, &#39;in_out_quint&#39;, &#39;in_sine&#39;, &#39;out_sine&#39;, &#39;in_out_sine&#39;] | <span title="typing.Callable">Callable</span>[[<span title="float">float</span>], <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A float, string, or callable defining the acceleration function. Defaults to 1.0 for linear progression.
 - If a float is provided, it acts as the exponent for the transformation.
 - If a string is provided, it must correspond to a preset easing function name as defined in <code>rpeasings</code>.
 - If a callable is provided, it should accept a float and return a transformed float.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The transformed percentage value after applying the acceleration function.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">Utils</span><span class="o">.</span><span class="n">accelerate</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="go">0.25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Utils</span><span class="o">.</span><span class="n">accelerate</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;in_expo&quot;</span><span class="p">)</span>
<span class="go">0.3125</span>
</code></pre></div>


<details class="notes" open>
  <summary>Notes</summary>
  <p>Refer to <a href="https://easings.net/">https://easings.net/</a> for guidance in choosing among the available easing functions.</p>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <p><a class="autorefs autorefs-internal" title="interpolate(pct, val1, val2, acc=1.0)

  
      staticmethod
  " href="#pyonfx.utils.Utils.interpolate"><code>interpolate</code></a>: Used for interpolating between values with easing.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>pyonfx/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">accelerate</span><span class="p">(</span>
    <span class="n">pct</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">acc</span><span class="p">:</span> <span class="p">(</span>
        <span class="nb">float</span>
        <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span>
            <span class="s2">&quot;in_back&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_back&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_back&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_bounce&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_bounce&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_bounce&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_circ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_circ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_circ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_cubic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_cubic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_cubic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_elastic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_elastic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_elastic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_expo&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_expo&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_expo&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_quad&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_quad&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_quad&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_quart&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_quart&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_quart&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_quint&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_quint&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_quint&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_sine&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_sine&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_sine&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transform a progress percentage using an acceleration function.</span>

<span class="sd">    Args:</span>
<span class="sd">        pct: A float representing the progress percentage, typically between 0.0 and 1.0.</span>
<span class="sd">        acc: A float, string, or callable defining the acceleration function. Defaults to 1.0 for linear progression.</span>
<span class="sd">             - If a float is provided, it acts as the exponent for the transformation.</span>
<span class="sd">             - If a string is provided, it must correspond to a preset easing function name as defined in `rpeasings`.</span>
<span class="sd">             - If a callable is provided, it should accept a float and return a transformed float.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The transformed percentage value after applying the acceleration function.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; Utils.accelerate(0.5, 2.0)</span>
<span class="sd">        0.25</span>
<span class="sd">        &gt;&gt;&gt; Utils.accelerate(0.5, &quot;in_expo&quot;)</span>
<span class="sd">        0.3125</span>

<span class="sd">    Notes:</span>
<span class="sd">        Refer to [https://easings.net/](https://easings.net/) for guidance in choosing among the available easing functions.</span>

<span class="sd">    See Also:</span>
<span class="sd">        [`interpolate`][pyonfx.utils.Utils.interpolate]: Used for interpolating between values with easing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">pct</span> <span class="o">==</span> <span class="mf">0.0</span> <span class="ow">or</span> <span class="n">pct</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pct</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
        <span class="n">fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="n">acc</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fn</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">rpeasings</span><span class="p">,</span> <span class="n">acc</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown easing function: </span><span class="si">{</span><span class="n">acc</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">acc</span><span class="p">):</span>
        <span class="n">fn</span> <span class="o">=</span> <span class="n">acc</span>  <span class="c1"># Assume it follows the Accelerator protocol</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Accelerator must be float, str, or callable&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="n">pct</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyonfx.utils.Utils.interpolate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">interpolate</span><span class="p">(</span><span class="n">pct</span><span class="p">,</span> <span class="n">val1</span><span class="p">,</span> <span class="n">val2</span><span class="p">,</span> <span class="n">acc</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Interpolate between two values with an optional acceleration (easing) function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pct</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A float in the range [0.0, 1.0] representing the interpolation factor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>val1</code>
            </td>
            <td>
                  <code><span title="pyonfx.utils._FloatStr">_FloatStr</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The starting value (ASS color, ASS alpha channel or number) for interpolation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>val2</code>
            </td>
            <td>
                  <code><span title="pyonfx.utils._FloatStr">_FloatStr</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ending value (ASS color, ASS alpha channel or number) for interpolation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>acc</code>
            </td>
            <td>
                  <code><span title="float">float</span> | <span title="typing.Literal">Literal</span>[&#39;in_back&#39;, &#39;out_back&#39;, &#39;in_out_back&#39;, &#39;in_bounce&#39;, &#39;out_bounce&#39;, &#39;in_out_bounce&#39;, &#39;in_circ&#39;, &#39;out_circ&#39;, &#39;in_out_circ&#39;, &#39;in_cubic&#39;, &#39;out_cubic&#39;, &#39;in_out_cubic&#39;, &#39;in_elastic&#39;, &#39;out_elastic&#39;, &#39;in_out_elastic&#39;, &#39;in_expo&#39;, &#39;out_expo&#39;, &#39;in_out_expo&#39;, &#39;in_quad&#39;, &#39;out_quad&#39;, &#39;in_out_quad&#39;, &#39;in_quart&#39;, &#39;out_quart&#39;, &#39;in_out_quart&#39;, &#39;in_quint&#39;, &#39;out_quint&#39;, &#39;in_out_quint&#39;, &#39;in_sine&#39;, &#39;out_sine&#39;, &#39;in_out_sine&#39;] | <span title="typing.Callable">Callable</span>[[<span title="float">float</span>], <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A float, string, or callable defining the acceleration function. Defaults to 1.0 for linear progression.
 - If a float is provided, it acts as the exponent for the transformation.
 - If a string is provided, it must correspond to a preset easing function name as defined in <code>rpeasings</code>.
 - If a callable is provided, it should accept a float and return a transformed float.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyonfx.utils._FloatStr">_FloatStr</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The interpolated value, either a number or a string, matching the type of <code>val1</code> and <code>val2</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">Utils</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="go">15.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Utils</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="s2">&quot;&amp;HFFFFFF&amp;&quot;</span><span class="p">,</span> <span class="s2">&quot;&amp;H000000&amp;&quot;</span><span class="p">)</span>
<span class="go">&amp;HE5E5E5&amp;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Utils</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;ease-in&quot;</span><span class="p">)</span>
<span class="go">13.05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Utils</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="go">12.5</span>
</code></pre></div>


<details class="notes" open>
  <summary>Notes</summary>
  <p>Refer to <a href="https://easings.net/">https://easings.net/</a> for guidance in choosing among the available easing functions.</p>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <p><a class="autorefs autorefs-internal" title="accelerate(pct, acc=1.0)

  
      staticmethod
  " href="#pyonfx.utils.Utils.accelerate"><code>accelerate</code></a>: Used to transform percentage values with easing.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>pyonfx/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">interpolate</span><span class="p">(</span>
    <span class="n">pct</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">val1</span><span class="p">:</span> <span class="n">_FloatStr</span><span class="p">,</span>
    <span class="n">val2</span><span class="p">:</span> <span class="n">_FloatStr</span><span class="p">,</span>
    <span class="n">acc</span><span class="p">:</span> <span class="p">(</span>
        <span class="nb">float</span>
        <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span>
            <span class="s2">&quot;in_back&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_back&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_back&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_bounce&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_bounce&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_bounce&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_circ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_circ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_circ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_cubic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_cubic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_cubic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_elastic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_elastic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_elastic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_expo&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_expo&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_expo&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_quad&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_quad&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_quad&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_quart&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_quart&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_quart&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_quint&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_quint&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_quint&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_sine&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_sine&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_sine&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_FloatStr</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Interpolate between two values with an optional acceleration (easing) function.</span>

<span class="sd">    Args:</span>
<span class="sd">        pct: A float in the range [0.0, 1.0] representing the interpolation factor.</span>
<span class="sd">        val1: The starting value (ASS color, ASS alpha channel or number) for interpolation.</span>
<span class="sd">        val2: The ending value (ASS color, ASS alpha channel or number) for interpolation.</span>
<span class="sd">        acc: A float, string, or callable defining the acceleration function. Defaults to 1.0 for linear progression.</span>
<span class="sd">             - If a float is provided, it acts as the exponent for the transformation.</span>
<span class="sd">             - If a string is provided, it must correspond to a preset easing function name as defined in `rpeasings`.</span>
<span class="sd">             - If a callable is provided, it should accept a float and return a transformed float.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The interpolated value, either a number or a string, matching the type of `val1` and `val2`.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; Utils.interpolate(0.5, 10, 20)</span>
<span class="sd">        15.0</span>
<span class="sd">        &gt;&gt;&gt; Utils.interpolate(0.9, &quot;&amp;HFFFFFF&amp;&quot;, &quot;&amp;H000000&amp;&quot;)</span>
<span class="sd">        &amp;HE5E5E5&amp;</span>
<span class="sd">        &gt;&gt;&gt; Utils.interpolate(0.5, 10, 20, &quot;ease-in&quot;)</span>
<span class="sd">        13.05</span>
<span class="sd">        &gt;&gt;&gt; Utils.interpolate(0.5, 10, 20, 2.0)</span>
<span class="sd">        12.5</span>

<span class="sd">    Notes:</span>
<span class="sd">        Refer to [https://easings.net/](https://easings.net/) for guidance in choosing among the available easing functions.</span>

<span class="sd">    See Also:</span>
<span class="sd">        [`accelerate`][pyonfx.utils.Utils.accelerate]: Used to transform percentage values with easing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">pct</span> <span class="o">&gt;</span> <span class="mf">1.0</span> <span class="ow">or</span> <span class="n">pct</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Percent value must be a float between 0.0 and 1.0, but yours was </span><span class="si">{</span><span class="n">pct</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Apply acceleration function</span>
    <span class="n">pct</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">.</span><span class="n">accelerate</span><span class="p">(</span><span class="n">pct</span><span class="p">,</span> <span class="n">acc</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">interpolate_numbers</span><span class="p">(</span><span class="n">val1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">val2</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">nonlocal</span> <span class="n">pct</span>
        <span class="k">return</span> <span class="n">val1</span> <span class="o">+</span> <span class="p">(</span><span class="n">val2</span> <span class="o">-</span> <span class="n">val1</span><span class="p">)</span> <span class="o">*</span> <span class="n">pct</span>

    <span class="c1"># Interpolating</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val1</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val2</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">val1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">val2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;ASS values must have the same type (either two alphas, two colors or two colors+alpha).&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">val1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="s2">&quot;&amp;HXX&amp;&quot;</span><span class="p">):</span>
            <span class="n">val1_dec</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">alpha_ass_to_dec</span><span class="p">(</span><span class="n">val1</span><span class="p">)</span>
            <span class="n">val2_dec</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">alpha_ass_to_dec</span><span class="p">(</span><span class="n">val2</span><span class="p">)</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">interpolate_numbers</span><span class="p">(</span><span class="n">val1_dec</span><span class="p">,</span> <span class="n">val2_dec</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="o">.</span><span class="n">alpha_dec_to_ass</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">val1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="s2">&quot;&amp;HBBGGRR&amp;&quot;</span><span class="p">):</span>
            <span class="n">val1_rgb</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">color_ass_to_rgb</span><span class="p">(</span><span class="n">val1</span><span class="p">)</span>
            <span class="n">val2_rgb</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">color_ass_to_rgb</span><span class="p">(</span><span class="n">val2</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val1_rgb</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val2_rgb</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">rgb</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">interpolate_numbers</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">val1_rgb</span><span class="p">,</span> <span class="n">val2_rgb</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rgb</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">Convert</span><span class="o">.</span><span class="n">color_rgb_to_ass</span><span class="p">(</span><span class="n">rgb</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid RGB color conversion&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">val1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="s2">&quot;&amp;HAABBGGRR&quot;</span><span class="p">):</span>
            <span class="n">val1_rgba</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">val1</span><span class="p">,</span> <span class="n">ColorModel</span><span class="o">.</span><span class="n">ASS</span><span class="p">,</span> <span class="n">ColorModel</span><span class="o">.</span><span class="n">RGBA</span><span class="p">)</span>
            <span class="n">val2_rgba</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">val2</span><span class="p">,</span> <span class="n">ColorModel</span><span class="o">.</span><span class="n">ASS</span><span class="p">,</span> <span class="n">ColorModel</span><span class="o">.</span><span class="n">RGBA</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val1_rgba</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val2_rgba</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">rgba</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                    <span class="n">interpolate_numbers</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">val1_rgba</span><span class="p">,</span> <span class="n">val2_rgba</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rgba</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">rgba</span><span class="p">,</span> <span class="n">ColorModel</span><span class="o">.</span><span class="n">RGBA</span><span class="p">,</span> <span class="n">ColorModel</span><span class="o">.</span><span class="n">ASS</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                        <span class="k">return</span> <span class="n">result</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid RGBA color conversion&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Provided inputs &#39;</span><span class="si">{</span><span class="n">val1</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="n">val2</span><span class="si">}</span><span class="s2">&#39; are not valid ASS strings.&quot;</span>
            <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val1</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val2</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">interpolate_numbers</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val1</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">val2</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="s2">&quot;Invalid input(s) type, either pass two strings or two numbers.&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyonfx.utils.Utils.retime" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">retime</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">output_line</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">word_syl_or_char</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">offset_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">offset_end</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Adjust the timing of a subtitle line based on a specified mode.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>mode</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;syl&#39;, &#39;presyl&#39;, &#39;postsyl&#39;, &#39;line&#39;, &#39;preline&#39;, &#39;postline&#39;, &#39;start2syl&#39;, &#39;syl2end&#39;, &#39;set&#39;, &#39;abs&#39;, &#39;sylpct&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string literal indicating the retime mode. Each mode applies a different timing adjustment strategy.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_line</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Line


  
      dataclass
   (pyonfx.ass_core.Line)" href="../ass_core/#pyonfx.ass_core.Line">Line</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The subtitle line object whose <code>start_time</code> and <code>end_time</code> will be adjusted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>line</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Line


  
      dataclass
   (pyonfx.ass_core.Line)" href="../ass_core/#pyonfx.ass_core.Line">Line</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The subtitle line object whose <code>start_time</code> and <code>end_time</code> will be used as reference.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>word_syl_or_char</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Word


  
      dataclass
   (pyonfx.ass_core.Word)" href="../ass_core/#pyonfx.ass_core.Word">Word</a> | <a class="autorefs autorefs-internal" title="Syllable


  
      dataclass
   (pyonfx.ass_core.Syllable)" href="../ass_core/#pyonfx.ass_core.Syllable">Syllable</a> | <a class="autorefs autorefs-internal" title="Char


  
      dataclass
   (pyonfx.ass_core.Char)" href="../ass_core/#pyonfx.ass_core.Char">Char</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An optional element (<a class="autorefs autorefs-internal" title="Word


  
      dataclass
  " href="../ass_core/#pyonfx.ass_core.Word"><code>Word</code></a>, <a class="autorefs autorefs-internal" title="Syllable


  
      dataclass
  " href="../ass_core/#pyonfx.ass_core.Syllable"><code>Syllable</code></a>, or <a class="autorefs autorefs-internal" title="Char


  
      dataclass
  " href="../ass_core/#pyonfx.ass_core.Char"><code>Char</code></a>)
              providing timing reference for modes that require relative timing. Must be provided for modes other than
              "line", "preline", "postline", "set", and "abs".</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>offset_start</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An optional integer offset (in milliseconds) to add to the computed start time.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>offset_end</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An optional integer offset (in milliseconds) to add to the computed end time.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Retiming a line based on the timing of a syllable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Utils</span><span class="o">.</span><span class="n">retime</span><span class="p">(</span><span class="s2">&quot;syl&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">syl</span><span class="p">,</span> <span class="n">offset_start</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">offset_end</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Retiming a line to keep its original timing (no adjustment)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Utils</span><span class="o">.</span><span class="n">retime</span><span class="p">(</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
</code></pre></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <p><a href="https://github.com/slackingway/karaOK/blob/master/autoload/ln.kara-templater-mod.lua#L352">kara-templater retime implementation</a></p>
</details>

            <details class="quote">
              <summary>Source code in <code>pyonfx/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">retime</span><span class="p">(</span>
    <span class="n">mode</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span>
        <span class="s2">&quot;syl&quot;</span><span class="p">,</span>
        <span class="s2">&quot;presyl&quot;</span><span class="p">,</span>
        <span class="s2">&quot;postsyl&quot;</span><span class="p">,</span>
        <span class="s2">&quot;line&quot;</span><span class="p">,</span>
        <span class="s2">&quot;preline&quot;</span><span class="p">,</span>
        <span class="s2">&quot;postline&quot;</span><span class="p">,</span>
        <span class="s2">&quot;start2syl&quot;</span><span class="p">,</span>
        <span class="s2">&quot;syl2end&quot;</span><span class="p">,</span>
        <span class="s2">&quot;set&quot;</span><span class="p">,</span>
        <span class="s2">&quot;abs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sylpct&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">output_line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span>
    <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span>
    <span class="n">word_syl_or_char</span><span class="p">:</span> <span class="n">Word</span> <span class="o">|</span> <span class="n">Syllable</span> <span class="o">|</span> <span class="n">Char</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">offset_start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">offset_end</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adjust the timing of a subtitle line based on a specified mode.</span>

<span class="sd">    Args:</span>
<span class="sd">        mode: A string literal indicating the retime mode. Each mode applies a different timing adjustment strategy.</span>
<span class="sd">        output_line: The subtitle line object whose `start_time` and `end_time` will be adjusted.</span>
<span class="sd">        line: The subtitle line object whose `start_time` and `end_time` will be used as reference.</span>
<span class="sd">        word_syl_or_char: An optional element ([`Word`][pyonfx.ass_core.Word], [`Syllable`][pyonfx.ass_core.Syllable], or [`Char`][pyonfx.ass_core.Char])</span>
<span class="sd">                          providing timing reference for modes that require relative timing. Must be provided for modes other than</span>
<span class="sd">                          &quot;line&quot;, &quot;preline&quot;, &quot;postline&quot;, &quot;set&quot;, and &quot;abs&quot;.</span>
<span class="sd">        offset_start: An optional integer offset (in milliseconds) to add to the computed start time.</span>
<span class="sd">        offset_end: An optional integer offset (in milliseconds) to add to the computed end time.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Retiming a line based on the timing of a syllable</span>
<span class="sd">        &gt;&gt;&gt; Utils.retime(&quot;syl&quot;, l, line, syl, offset_start=10, offset_end=5)</span>
<span class="sd">        &gt;&gt;&gt; # Retiming a line to keep its original timing (no adjustment)</span>
<span class="sd">        &gt;&gt;&gt; Utils.retime(&quot;line&quot;, l, line)</span>

<span class="sd">    See Also:</span>
<span class="sd">        [kara-templater retime implementation](https://github.com/slackingway/karaOK/blob/master/autoload/ln.kara-templater-mod.lua#L352)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;syl&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">word_syl_or_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;word_syl_or_char must be provided for mode &#39;syl&#39;&quot;</span><span class="p">)</span>
        <span class="n">new_start</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">start_time</span>
        <span class="n">new_end</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">end_time</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;presyl&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">word_syl_or_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;word_syl_or_char must be provided for mode &#39;presyl&#39;&quot;</span><span class="p">)</span>
        <span class="n">new_start</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">start_time</span>
        <span class="n">new_end</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">start_time</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;postsyl&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">word_syl_or_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;word_syl_or_char must be provided for mode &#39;postsyl&#39;&quot;</span><span class="p">)</span>
        <span class="n">new_start</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">end_time</span>
        <span class="n">new_end</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">end_time</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;line&quot;</span><span class="p">:</span>
        <span class="n">new_start</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span>
        <span class="n">new_end</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">end_time</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;preline&quot;</span><span class="p">:</span>
        <span class="n">new_start</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span>
        <span class="n">new_end</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;postline&quot;</span><span class="p">:</span>
        <span class="n">new_start</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">end_time</span>
        <span class="n">new_end</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">end_time</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;start2syl&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">word_syl_or_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;word_syl_or_char must be provided for mode &#39;start2syl&#39;&quot;</span>
            <span class="p">)</span>
        <span class="n">new_start</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span>
        <span class="n">new_end</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">start_time</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;syl2end&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">word_syl_or_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;word_syl_or_char must be provided for mode &#39;syl2end&#39;&quot;</span><span class="p">)</span>
        <span class="n">new_start</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">end_time</span>
        <span class="n">new_end</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">end_time</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;set&quot;</span><span class="p">,</span> <span class="s2">&quot;abs&quot;</span><span class="p">):</span>
        <span class="n">new_start</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">new_end</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;sylpct&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">word_syl_or_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;word_syl_or_char must be provided for mode &#39;sylpct&#39;&quot;</span><span class="p">)</span>
        <span class="n">new_start</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">line</span><span class="o">.</span><span class="n">start_time</span>
            <span class="o">+</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">start_time</span>
            <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">offset_start</span> <span class="o">*</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">duration</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">new_end</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">line</span><span class="o">.</span><span class="n">start_time</span>
            <span class="o">+</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">start_time</span>
            <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">offset_end</span> <span class="o">*</span> <span class="n">word_syl_or_char</span><span class="o">.</span><span class="n">duration</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown retime mode: </span><span class="si">{</span><span class="n">mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="o">!=</span> <span class="s2">&quot;sylpct&quot;</span><span class="p">:</span>
        <span class="n">new_start</span> <span class="o">+=</span> <span class="n">offset_start</span>
        <span class="n">new_end</span> <span class="o">+=</span> <span class="n">offset_end</span>

    <span class="n">output_line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">new_start</span>
    <span class="n">output_line</span><span class="o">.</span><span class="n">end_time</span> <span class="o">=</span> <span class="n">new_end</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pyonfx.utils.FrameUtility" class="doc doc-heading">
            <code>FrameUtility</code>


</h2>


    <div class="doc doc-contents ">


        <p>Provide an accurate frame-by-frame iteration engine for subtitle processing.</p>
<p>This class enables precise operations on video frames by dividing a time interval (from <code>start_ms</code> to <code>end_ms</code>)
into discrete frame segments based on a given timestamps object. It calculates the corresponding frame indices and yields
a tuple for each frame segment containing:
  - The start time of the frame segment (in milliseconds).
  - The end time of the frame segment (in milliseconds), clamped to the video duration.
  - The current frame index (starting at 1).
  - The total number of frame segments.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assume `io.input_timestamps` is an instance of ABCTimestamps and the video has a 20 fps frame rate (50 ms per frame)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span> <span class="o">=</span> <span class="n">FrameUtility</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">input_timestamps</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">fu</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Frame </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">Frame 1/3: 0 - 25</span>
<span class="go">Frame 2/3: 25 - 75</span>
<span class="go">Frame 3/3: 75 - 125</span>
</code></pre></div>


<details class="notes" open>
  <summary>Notes</summary>
  <p>A mid-point approach is used to center each frame's timing around the player's seek time, ensuring that subtitles
remain visible throughout the entire frame duration. This method is reliable for both constant frame rate (CFR) and
variable frame rate (VFR) videos.</p>
</details>






              <details class="quote">
                <summary>Source code in <code>pyonfx/utils.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">FrameUtility</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provide an accurate frame-by-frame iteration engine for subtitle processing.</span>

<span class="sd">    This class enables precise operations on video frames by dividing a time interval (from `start_ms` to `end_ms`)</span>
<span class="sd">    into discrete frame segments based on a given timestamps object. It calculates the corresponding frame indices and yields</span>
<span class="sd">    a tuple for each frame segment containing:</span>
<span class="sd">      - The start time of the frame segment (in milliseconds).</span>
<span class="sd">      - The end time of the frame segment (in milliseconds), clamped to the video duration.</span>
<span class="sd">      - The current frame index (starting at 1).</span>
<span class="sd">      - The total number of frame segments.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Assume `io.input_timestamps` is an instance of ABCTimestamps and the video has a 20 fps frame rate (50 ms per frame)</span>
<span class="sd">        &gt;&gt;&gt; fu = FrameUtility(0, 110, io.input_timestamps)</span>
<span class="sd">        &gt;&gt;&gt; for s, e, i, n in fu:</span>
<span class="sd">        ...     print(f&quot;Frame {i}/{n}: {s} - {e}&quot;)</span>
<span class="sd">        Frame 1/3: 0 - 25</span>
<span class="sd">        Frame 2/3: 25 - 75</span>
<span class="sd">        Frame 3/3: 75 - 125</span>

<span class="sd">    Notes:</span>
<span class="sd">        A mid-point approach is used to center each frame&#39;s timing around the player&#39;s seek time, ensuring that subtitles</span>
<span class="sd">        remain visible throughout the entire frame duration. This method is reliable for both constant frame rate (CFR) and</span>
<span class="sd">        variable frame rate (VFR) videos.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">start_ms</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">end_ms</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">timestamps</span><span class="p">:</span> <span class="n">ABCTimestamps</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">n_fr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the FrameUtility object.</span>

<span class="sd">        Args:</span>
<span class="sd">            start_ms: A positive integer representing the starting time (in milliseconds) of the interval.</span>
<span class="sd">            end_ms: A positive integer representing the ending time (in milliseconds) of the interval.</span>
<span class="sd">            timestamps: An instance of `ABCTimestamps` used to convert between time values and frame numbers.</span>
<span class="sd">            n_fr: An optional positive integer specifying the number of frames to process per iteration (default is 1).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check for invalid values</span>
        <span class="k">if</span> <span class="n">start_ms</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">end_ms</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Parameters &#39;start_ms&#39; and &#39;end_ms&#39; must be &gt;= 0.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">end_ms</span> <span class="o">&lt;</span> <span class="n">start_ms</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Parameter &#39;start_ms&#39; is expected to be &lt;= &#39;end_ms&#39;.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n_fr</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Parameter &#39;n_fr&#39; must be &gt; 0.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">timestamps</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Parameter &#39;timestamps&#39; cannot be None (hint: does your ASS file have a video specified?).&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">timestamps</span> <span class="o">=</span> <span class="n">timestamps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_ms</span> <span class="o">=</span> <span class="n">start_ms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_ms</span> <span class="o">=</span> <span class="n">end_ms</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">start_fr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">curr_fr</span> <span class="o">=</span> <span class="n">timestamps</span><span class="o">.</span><span class="n">time_to_frame</span><span class="p">(</span>
            <span class="n">start_ms</span><span class="p">,</span> <span class="n">TimeType</span><span class="o">.</span><span class="n">START</span><span class="p">,</span> <span class="mi">3</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_fr</span> <span class="o">=</span> <span class="n">timestamps</span><span class="o">.</span><span class="n">time_to_frame</span><span class="p">(</span><span class="n">end_ms</span><span class="p">,</span> <span class="n">TimeType</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_ms_snapped</span> <span class="o">=</span> <span class="n">timestamps</span><span class="o">.</span><span class="n">frame_to_time</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_fr</span><span class="p">,</span> <span class="n">TimeType</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">True</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_fr</span> <span class="o">=</span> <span class="n">n_fr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_fr</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_fr</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">duration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Derived duration of the frame window in milliseconds.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_ms</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_ms</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Generate values for the frames on demand. The end time is always clamped to the end_ms value.</span>
        <span class="k">for</span> <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_fr</span><span class="p">):</span>
            <span class="k">yield</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">timestamps</span><span class="o">.</span><span class="n">frame_to_time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">curr_fr</span><span class="p">,</span> <span class="n">TimeType</span><span class="o">.</span><span class="n">START</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
                <span class="nb">min</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">timestamps</span><span class="o">.</span><span class="n">frame_to_time</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">curr_fr</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_fr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TimeType</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">True</span>
                    <span class="p">),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">end_ms_snapped</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">curr_fr</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_fr</span>

        <span class="c1"># Reset the object to make it usable again</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reset the frame utility to its initial state.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">curr_fr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_fr</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">end_value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">acc</span><span class="p">:</span> <span class="p">(</span>
            <span class="nb">float</span>
            <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span>
                <span class="s2">&quot;in_back&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_back&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_back&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_bounce&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_bounce&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_bounce&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_circ&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_circ&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_circ&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_cubic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_cubic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_cubic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_elastic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_elastic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_elastic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_expo&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_expo&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_expo&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_quad&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_quad&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_quad&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_quart&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_quart&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_quart&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_quint&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_quint&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_quint&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_sine&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_sine&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_sine&quot;</span><span class="p">,</span>
            <span class="p">]</span>
            <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span>
        <span class="p">)</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply a frame-by-frame numeric transformation similar to the ASS &#39;\\t&#39; tag.</span>

<span class="sd">        This method computes an adjustment value for the current frame by interpolating between 0 and `end_value` over a</span>
<span class="sd">        specified time interval defined by `start_time` and `end_time`. Mimicking the behavior of the ASS &#39;\\t&#39; tag,</span>
<span class="sd">        it calculates the interpolation progress based on the midpoint of the current frame within the interval and applies</span>
<span class="sd">        an optional acceleration (easing) function (`acc`) to modulate the transformation.</span>

<span class="sd">        Args:</span>
<span class="sd">            start_time: The start time (in milliseconds) of the transformation interval (relative to the iteration range).</span>
<span class="sd">            end_time: The end time (in milliseconds) of the transformation interval (relative to the iteration range).</span>
<span class="sd">            end_value: The final adjustment value to be reached at the end of the interval.</span>
<span class="sd">            acc: A float, string, or callable defining the acceleration function. Defaults to 1.0 for linear progression.</span>
<span class="sd">                 - If a float is provided, it acts as the exponent for the transformation.</span>
<span class="sd">                 - If a string is provided, it must correspond to a preset easing function name as defined in `rpeasings`.</span>
<span class="sd">                 - If a callable is provided, it should accept a float and return a transformed float.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: The computed adjustment value for the current frame.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; # Let&#39;s assume to have an Ass object named &quot;io&quot; having a 20 fps video (i.e. frames are 50 ms long)</span>
<span class="sd">            &gt;&gt;&gt; fu = FrameUtility(25, 225, io.input_timestamps)</span>
<span class="sd">            &gt;&gt;&gt; for s, e, i, n in fu:</span>
<span class="sd">            ...     # We would like to transform the fsc value</span>
<span class="sd">            ...     # from 100 up 150 for the first 100 ms,</span>
<span class="sd">            ...     # and then from 150 to 100 for the remaining 200 ms</span>
<span class="sd">            ...     fsc = 100</span>
<span class="sd">            ...     fsc += fu.add(0, 100, 50)</span>
<span class="sd">            ...     fsc += fu.add(100, 200, -50)</span>
<span class="sd">            ...     print(f&quot;Frame {i}/{n}: {s} - {e}; fsc: {fsc}&quot;)</span>
<span class="sd">            Frame 1/4: 25 - 75; fsc: 112.5</span>
<span class="sd">            Frame 2/4: 75 - 125; fsc: 137.5</span>
<span class="sd">            Frame 3/4: 125 - 175; fsc: 137.5</span>
<span class="sd">            Frame 4/4: 175 - 225; fsc: 112.5</span>

<span class="sd">        Notes:</span>
<span class="sd">            Should be called inside a loop iterating over a `FrameUtility` instance.</span>

<span class="sd">        See Also:</span>
<span class="sd">            [`accelerate`][pyonfx.utils.Utils.accelerate]: For transforming percentage values with easing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">curr_ms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamps</span><span class="o">.</span><span class="n">frame_to_time</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_fr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">TimeType</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">True</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">curr_ms</span> <span class="o">&lt;=</span> <span class="n">start_time</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">curr_ms</span> <span class="o">&gt;=</span> <span class="n">end_time</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">end_value</span>

        <span class="n">curr</span> <span class="o">=</span> <span class="n">curr_ms</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="n">total</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">Utils</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">curr</span> <span class="o">/</span> <span class="n">total</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">end_value</span><span class="p">,</span> <span class="n">acc</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">interpolate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">start_value</span><span class="p">:</span> <span class="n">_FloatStr</span><span class="p">,</span>
        <span class="n">end_value</span><span class="p">:</span> <span class="n">_FloatStr</span><span class="p">,</span>
        <span class="n">acc</span><span class="p">:</span> <span class="p">(</span>
            <span class="nb">float</span>
            <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span>
                <span class="s2">&quot;in_back&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_back&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_back&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_bounce&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_bounce&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_bounce&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_circ&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_circ&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_circ&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_cubic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_cubic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_cubic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_elastic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_elastic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_elastic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_expo&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_expo&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_expo&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_quad&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_quad&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_quad&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_quart&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_quart&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_quart&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_quint&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_quint&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_quint&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_sine&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out_sine&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in_out_sine&quot;</span><span class="p">,</span>
            <span class="p">]</span>
            <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span>
        <span class="p">)</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_FloatStr</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Interpolate between two values over a time window, aligned to the current frame.</span>

<span class="sd">        This behaves like `add`, but instead of interpolating from 0 to `end_value`, it</span>
<span class="sd">        interpolates from `start_value` to `end_value`, supporting numbers and ASS</span>
<span class="sd">        color/alpha strings, with optional easing.</span>

<span class="sd">        Args:</span>
<span class="sd">            start_time: Window start time in milliseconds (relative to the iteration range).</span>
<span class="sd">            end_time: Window end time in milliseconds (relative to the iteration range).</span>
<span class="sd">            start_value: Initial value at `start_time` (number or ASS color/alpha string).</span>
<span class="sd">            end_value: Final value at `end_time` (number or ASS color/alpha string).</span>
<span class="sd">            acc: Easing/acceleration to apply; same semantics as in `Utils.interpolate`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The interpolated value for the current frame time.</span>

<span class="sd">        Notes:</span>
<span class="sd">            Should be called inside a loop iterating over a `FrameUtility` instance.</span>

<span class="sd">        See Also:</span>
<span class="sd">            [`add`][pyonfx.utils.FrameUtility.add].</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">curr_ms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamps</span><span class="o">.</span><span class="n">frame_to_time</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_fr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">TimeType</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">True</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">curr_ms</span> <span class="o">&lt;=</span> <span class="n">start_time</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">start_value</span>
        <span class="k">elif</span> <span class="n">curr_ms</span> <span class="o">&gt;=</span> <span class="n">end_time</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">end_value</span>

        <span class="n">curr</span> <span class="o">=</span> <span class="n">curr_ms</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="n">total</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">Utils</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">curr</span> <span class="o">/</span> <span class="n">total</span><span class="p">,</span> <span class="n">start_value</span><span class="p">,</span> <span class="n">end_value</span><span class="p">,</span> <span class="n">acc</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="pyonfx.utils.FrameUtility.duration" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">duration</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Derived duration of the frame window in milliseconds.</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="pyonfx.utils.FrameUtility.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">start_ms</span><span class="p">,</span> <span class="n">end_ms</span><span class="p">,</span> <span class="n">timestamps</span><span class="p">,</span> <span class="n">n_fr</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize the FrameUtility object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>start_ms</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A positive integer representing the starting time (in milliseconds) of the interval.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_ms</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A positive integer representing the ending time (in milliseconds) of the interval.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timestamps</code>
            </td>
            <td>
                  <code><span title="video_timestamps.ABCTimestamps">ABCTimestamps</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An instance of <code>ABCTimestamps</code> used to convert between time values and frame numbers.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_fr</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An optional positive integer specifying the number of frames to process per iteration (default is 1).</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pyonfx/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">start_ms</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">end_ms</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">timestamps</span><span class="p">:</span> <span class="n">ABCTimestamps</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_fr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the FrameUtility object.</span>

<span class="sd">    Args:</span>
<span class="sd">        start_ms: A positive integer representing the starting time (in milliseconds) of the interval.</span>
<span class="sd">        end_ms: A positive integer representing the ending time (in milliseconds) of the interval.</span>
<span class="sd">        timestamps: An instance of `ABCTimestamps` used to convert between time values and frame numbers.</span>
<span class="sd">        n_fr: An optional positive integer specifying the number of frames to process per iteration (default is 1).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check for invalid values</span>
    <span class="k">if</span> <span class="n">start_ms</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">end_ms</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Parameters &#39;start_ms&#39; and &#39;end_ms&#39; must be &gt;= 0.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">end_ms</span> <span class="o">&lt;</span> <span class="n">start_ms</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Parameter &#39;start_ms&#39; is expected to be &lt;= &#39;end_ms&#39;.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n_fr</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Parameter &#39;n_fr&#39; must be &gt; 0.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">timestamps</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Parameter &#39;timestamps&#39; cannot be None (hint: does your ASS file have a video specified?).&quot;</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">timestamps</span> <span class="o">=</span> <span class="n">timestamps</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_ms</span> <span class="o">=</span> <span class="n">start_ms</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">end_ms</span> <span class="o">=</span> <span class="n">end_ms</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">start_fr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">curr_fr</span> <span class="o">=</span> <span class="n">timestamps</span><span class="o">.</span><span class="n">time_to_frame</span><span class="p">(</span>
        <span class="n">start_ms</span><span class="p">,</span> <span class="n">TimeType</span><span class="o">.</span><span class="n">START</span><span class="p">,</span> <span class="mi">3</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">end_fr</span> <span class="o">=</span> <span class="n">timestamps</span><span class="o">.</span><span class="n">time_to_frame</span><span class="p">(</span><span class="n">end_ms</span><span class="p">,</span> <span class="n">TimeType</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">end_ms_snapped</span> <span class="o">=</span> <span class="n">timestamps</span><span class="o">.</span><span class="n">frame_to_time</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_fr</span><span class="p">,</span> <span class="n">TimeType</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">True</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_fr</span> <span class="o">=</span> <span class="n">n_fr</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_fr</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_fr</span> <span class="o">+</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyonfx.utils.FrameUtility.reset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reset</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Reset the frame utility to its initial state.</p>


            <details class="quote">
              <summary>Source code in <code>pyonfx/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reset the frame utility to its initial state.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">curr_fr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_fr</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyonfx.utils.FrameUtility.add" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">,</span> <span class="n">end_value</span><span class="p">,</span> <span class="n">acc</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Apply a frame-by-frame numeric transformation similar to the ASS '\t' tag.</p>
<p>This method computes an adjustment value for the current frame by interpolating between 0 and <code>end_value</code> over a
specified time interval defined by <code>start_time</code> and <code>end_time</code>. Mimicking the behavior of the ASS '\t' tag,
it calculates the interpolation progress based on the midpoint of the current frame within the interval and applies
an optional acceleration (easing) function (<code>acc</code>) to modulate the transformation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>start_time</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The start time (in milliseconds) of the transformation interval (relative to the iteration range).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_time</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The end time (in milliseconds) of the transformation interval (relative to the iteration range).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_value</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The final adjustment value to be reached at the end of the interval.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>acc</code>
            </td>
            <td>
                  <code><span title="float">float</span> | <span title="typing.Literal">Literal</span>[&#39;in_back&#39;, &#39;out_back&#39;, &#39;in_out_back&#39;, &#39;in_bounce&#39;, &#39;out_bounce&#39;, &#39;in_out_bounce&#39;, &#39;in_circ&#39;, &#39;out_circ&#39;, &#39;in_out_circ&#39;, &#39;in_cubic&#39;, &#39;out_cubic&#39;, &#39;in_out_cubic&#39;, &#39;in_elastic&#39;, &#39;out_elastic&#39;, &#39;in_out_elastic&#39;, &#39;in_expo&#39;, &#39;out_expo&#39;, &#39;in_out_expo&#39;, &#39;in_quad&#39;, &#39;out_quad&#39;, &#39;in_out_quad&#39;, &#39;in_quart&#39;, &#39;out_quart&#39;, &#39;in_out_quart&#39;, &#39;in_quint&#39;, &#39;out_quint&#39;, &#39;in_out_quint&#39;, &#39;in_sine&#39;, &#39;out_sine&#39;, &#39;in_out_sine&#39;] | <span title="typing.Callable">Callable</span>[[<span title="float">float</span>], <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A float, string, or callable defining the acceleration function. Defaults to 1.0 for linear progression.
 - If a float is provided, it acts as the exponent for the transformation.
 - If a string is provided, it must correspond to a preset easing function name as defined in <code>rpeasings</code>.
 - If a callable is provided, it should accept a float and return a transformed float.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The computed adjustment value for the current frame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Let&#39;s assume to have an Ass object named &quot;io&quot; having a 20 fps video (i.e. frames are 50 ms long)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span> <span class="o">=</span> <span class="n">FrameUtility</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">input_timestamps</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">fu</span><span class="p">:</span>
<span class="gp">... </span>    <span class="c1"># We would like to transform the fsc value</span>
<span class="gp">... </span>    <span class="c1"># from 100 up 150 for the first 100 ms,</span>
<span class="gp">... </span>    <span class="c1"># and then from 150 to 100 for the remaining 200 ms</span>
<span class="gp">... </span>    <span class="n">fsc</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">... </span>    <span class="n">fsc</span> <span class="o">+=</span> <span class="n">fu</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">fsc</span> <span class="o">+=</span> <span class="n">fu</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Frame </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">; fsc: </span><span class="si">{</span><span class="n">fsc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">Frame 1/4: 25 - 75; fsc: 112.5</span>
<span class="go">Frame 2/4: 75 - 125; fsc: 137.5</span>
<span class="go">Frame 3/4: 125 - 175; fsc: 137.5</span>
<span class="go">Frame 4/4: 175 - 225; fsc: 112.5</span>
</code></pre></div>


<details class="notes" open>
  <summary>Notes</summary>
  <p>Should be called inside a loop iterating over a <code>FrameUtility</code> instance.</p>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <p><a class="autorefs autorefs-internal" title="accelerate(pct, acc=1.0)

  
      staticmethod
  " href="#pyonfx.utils.Utils.accelerate"><code>accelerate</code></a>: For transforming percentage values with easing.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>pyonfx/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">start_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">end_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">end_value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">acc</span><span class="p">:</span> <span class="p">(</span>
        <span class="nb">float</span>
        <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span>
            <span class="s2">&quot;in_back&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_back&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_back&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_bounce&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_bounce&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_bounce&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_circ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_circ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_circ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_cubic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_cubic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_cubic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_elastic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_elastic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_elastic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_expo&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_expo&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_expo&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_quad&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_quad&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_quad&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_quart&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_quart&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_quart&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_quint&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_quint&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_quint&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_sine&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_sine&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_sine&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply a frame-by-frame numeric transformation similar to the ASS &#39;\\t&#39; tag.</span>

<span class="sd">    This method computes an adjustment value for the current frame by interpolating between 0 and `end_value` over a</span>
<span class="sd">    specified time interval defined by `start_time` and `end_time`. Mimicking the behavior of the ASS &#39;\\t&#39; tag,</span>
<span class="sd">    it calculates the interpolation progress based on the midpoint of the current frame within the interval and applies</span>
<span class="sd">    an optional acceleration (easing) function (`acc`) to modulate the transformation.</span>

<span class="sd">    Args:</span>
<span class="sd">        start_time: The start time (in milliseconds) of the transformation interval (relative to the iteration range).</span>
<span class="sd">        end_time: The end time (in milliseconds) of the transformation interval (relative to the iteration range).</span>
<span class="sd">        end_value: The final adjustment value to be reached at the end of the interval.</span>
<span class="sd">        acc: A float, string, or callable defining the acceleration function. Defaults to 1.0 for linear progression.</span>
<span class="sd">             - If a float is provided, it acts as the exponent for the transformation.</span>
<span class="sd">             - If a string is provided, it must correspond to a preset easing function name as defined in `rpeasings`.</span>
<span class="sd">             - If a callable is provided, it should accept a float and return a transformed float.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The computed adjustment value for the current frame.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Let&#39;s assume to have an Ass object named &quot;io&quot; having a 20 fps video (i.e. frames are 50 ms long)</span>
<span class="sd">        &gt;&gt;&gt; fu = FrameUtility(25, 225, io.input_timestamps)</span>
<span class="sd">        &gt;&gt;&gt; for s, e, i, n in fu:</span>
<span class="sd">        ...     # We would like to transform the fsc value</span>
<span class="sd">        ...     # from 100 up 150 for the first 100 ms,</span>
<span class="sd">        ...     # and then from 150 to 100 for the remaining 200 ms</span>
<span class="sd">        ...     fsc = 100</span>
<span class="sd">        ...     fsc += fu.add(0, 100, 50)</span>
<span class="sd">        ...     fsc += fu.add(100, 200, -50)</span>
<span class="sd">        ...     print(f&quot;Frame {i}/{n}: {s} - {e}; fsc: {fsc}&quot;)</span>
<span class="sd">        Frame 1/4: 25 - 75; fsc: 112.5</span>
<span class="sd">        Frame 2/4: 75 - 125; fsc: 137.5</span>
<span class="sd">        Frame 3/4: 125 - 175; fsc: 137.5</span>
<span class="sd">        Frame 4/4: 175 - 225; fsc: 112.5</span>

<span class="sd">    Notes:</span>
<span class="sd">        Should be called inside a loop iterating over a `FrameUtility` instance.</span>

<span class="sd">    See Also:</span>
<span class="sd">        [`accelerate`][pyonfx.utils.Utils.accelerate]: For transforming percentage values with easing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">curr_ms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamps</span><span class="o">.</span><span class="n">frame_to_time</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_fr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">TimeType</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">True</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">curr_ms</span> <span class="o">&lt;=</span> <span class="n">start_time</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">curr_ms</span> <span class="o">&gt;=</span> <span class="n">end_time</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">end_value</span>

    <span class="n">curr</span> <span class="o">=</span> <span class="n">curr_ms</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="k">return</span> <span class="n">Utils</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">curr</span> <span class="o">/</span> <span class="n">total</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">end_value</span><span class="p">,</span> <span class="n">acc</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyonfx.utils.FrameUtility.interpolate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">interpolate</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">,</span> <span class="n">start_value</span><span class="p">,</span> <span class="n">end_value</span><span class="p">,</span> <span class="n">acc</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Interpolate between two values over a time window, aligned to the current frame.</p>
<p>This behaves like <code>add</code>, but instead of interpolating from 0 to <code>end_value</code>, it
interpolates from <code>start_value</code> to <code>end_value</code>, supporting numbers and ASS
color/alpha strings, with optional easing.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>start_time</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Window start time in milliseconds (relative to the iteration range).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_time</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Window end time in milliseconds (relative to the iteration range).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>start_value</code>
            </td>
            <td>
                  <code><span title="pyonfx.utils._FloatStr">_FloatStr</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial value at <code>start_time</code> (number or ASS color/alpha string).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_value</code>
            </td>
            <td>
                  <code><span title="pyonfx.utils._FloatStr">_FloatStr</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Final value at <code>end_time</code> (number or ASS color/alpha string).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>acc</code>
            </td>
            <td>
                  <code><span title="float">float</span> | <span title="typing.Literal">Literal</span>[&#39;in_back&#39;, &#39;out_back&#39;, &#39;in_out_back&#39;, &#39;in_bounce&#39;, &#39;out_bounce&#39;, &#39;in_out_bounce&#39;, &#39;in_circ&#39;, &#39;out_circ&#39;, &#39;in_out_circ&#39;, &#39;in_cubic&#39;, &#39;out_cubic&#39;, &#39;in_out_cubic&#39;, &#39;in_elastic&#39;, &#39;out_elastic&#39;, &#39;in_out_elastic&#39;, &#39;in_expo&#39;, &#39;out_expo&#39;, &#39;in_out_expo&#39;, &#39;in_quad&#39;, &#39;out_quad&#39;, &#39;in_out_quad&#39;, &#39;in_quart&#39;, &#39;out_quart&#39;, &#39;in_out_quart&#39;, &#39;in_quint&#39;, &#39;out_quint&#39;, &#39;in_out_quint&#39;, &#39;in_sine&#39;, &#39;out_sine&#39;, &#39;in_out_sine&#39;] | <span title="typing.Callable">Callable</span>[[<span title="float">float</span>], <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Easing/acceleration to apply; same semantics as in <code>Utils.interpolate</code>.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyonfx.utils._FloatStr">_FloatStr</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The interpolated value for the current frame time.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>Should be called inside a loop iterating over a <code>FrameUtility</code> instance.</p>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <p><a class="autorefs autorefs-internal" title="add(start_time, end_time, end_value, acc=1.0)" href="#pyonfx.utils.FrameUtility.add"><code>add</code></a>.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>pyonfx/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">interpolate</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">start_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">end_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">start_value</span><span class="p">:</span> <span class="n">_FloatStr</span><span class="p">,</span>
    <span class="n">end_value</span><span class="p">:</span> <span class="n">_FloatStr</span><span class="p">,</span>
    <span class="n">acc</span><span class="p">:</span> <span class="p">(</span>
        <span class="nb">float</span>
        <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span>
            <span class="s2">&quot;in_back&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_back&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_back&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_bounce&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_bounce&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_bounce&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_circ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_circ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_circ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_cubic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_cubic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_cubic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_elastic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_elastic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_elastic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_expo&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_expo&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_expo&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_quad&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_quad&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_quad&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_quart&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_quart&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_quart&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_quint&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_quint&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_quint&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_sine&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out_sine&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in_out_sine&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_FloatStr</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Interpolate between two values over a time window, aligned to the current frame.</span>

<span class="sd">    This behaves like `add`, but instead of interpolating from 0 to `end_value`, it</span>
<span class="sd">    interpolates from `start_value` to `end_value`, supporting numbers and ASS</span>
<span class="sd">    color/alpha strings, with optional easing.</span>

<span class="sd">    Args:</span>
<span class="sd">        start_time: Window start time in milliseconds (relative to the iteration range).</span>
<span class="sd">        end_time: Window end time in milliseconds (relative to the iteration range).</span>
<span class="sd">        start_value: Initial value at `start_time` (number or ASS color/alpha string).</span>
<span class="sd">        end_value: Final value at `end_time` (number or ASS color/alpha string).</span>
<span class="sd">        acc: Easing/acceleration to apply; same semantics as in `Utils.interpolate`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The interpolated value for the current frame time.</span>

<span class="sd">    Notes:</span>
<span class="sd">        Should be called inside a loop iterating over a `FrameUtility` instance.</span>

<span class="sd">    See Also:</span>
<span class="sd">        [`add`][pyonfx.utils.FrameUtility.add].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">curr_ms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamps</span><span class="o">.</span><span class="n">frame_to_time</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_fr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">TimeType</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">True</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">curr_ms</span> <span class="o">&lt;=</span> <span class="n">start_time</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">start_value</span>
    <span class="k">elif</span> <span class="n">curr_ms</span> <span class="o">&gt;=</span> <span class="n">end_time</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">end_value</span>

    <span class="n">curr</span> <span class="o">=</span> <span class="n">curr_ms</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="k">return</span> <span class="n">Utils</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">curr</span> <span class="o">/</span> <span class="n">total</span><span class="p">,</span> <span class="n">start_value</span><span class="p">,</span> <span class="n">end_value</span><span class="p">,</span> <span class="n">acc</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pyonfx.utils.ColorUtility" class="doc doc-heading">
            <code>ColorUtility</code>


</h2>


    <div class="doc doc-contents ">


        <p>Extract and manage color transformations from ASS subtitle lines.</p>
<p>Parses ASS Line objects to extract color change commands (\1c, \3c, \4c)
and their transformations (\t tags), and provides interpolated color values
for smooth transitions during subtitle rendering.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">cu</span> <span class="o">=</span> <span class="n">ColorUtility</span><span class="p">(</span><span class="n">subtitle_lines</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color_tags</span> <span class="o">=</span> <span class="n">cu</span><span class="o">.</span><span class="n">get_color_change</span><span class="p">(</span><span class="n">current_line</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Color tags: </span><span class="si">{</span><span class="n">color_tags</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">\1c&amp;HFFFFFF&amp;\t(100,200,\1c&amp;H000000&amp;)</span>
</code></pre></div>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Create only one ColorUtility instance per ASS file for optimal performance.</li>
<li>Lines without explicit colors inherit from the last defined color state.</li>
</ul>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <p><code>Utils.interpolate</code> for color interpolation between ASS color values.</p>
</details>






              <details class="quote">
                <summary>Source code in <code>pyonfx/utils.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ColorUtility</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract and manage color transformations from ASS subtitle lines.</span>

<span class="sd">    Parses ASS Line objects to extract color change commands (\\1c, \\3c, \\4c)</span>
<span class="sd">    and their transformations (\\t tags), and provides interpolated color values</span>
<span class="sd">    for smooth transitions during subtitle rendering.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; cu = ColorUtility(subtitle_lines)</span>
<span class="sd">        &gt;&gt;&gt; color_tags = cu.get_color_change(current_line)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;Color tags: {color_tags}&quot;)</span>
<span class="sd">        \\1c&amp;HFFFFFF&amp;\\t(100,200,\\1c&amp;H000000&amp;)</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Create only one ColorUtility instance per ASS file for optimal performance.</span>
<span class="sd">        - Lines without explicit colors inherit from the last defined color state.</span>

<span class="sd">    See Also:</span>
<span class="sd">        `Utils.interpolate` for color interpolation between ASS color values.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Compiled regex patterns</span>
    <span class="n">_PATTERNS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;{.*?}&quot;</span><span class="p">),</span>
        <span class="s2">&quot;transform&quot;</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">t\(\s*(-?\d+?)\s*,\s*(-?\d+?)\s*,\s*(.+?)\s*\)&quot;</span><span class="p">),</span>
        <span class="s2">&quot;c1&quot;</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">1c(&amp;H[0-9A-Fa-f]</span><span class="si">{6}</span><span class="s2">&amp;)&quot;</span><span class="p">),</span>
        <span class="s2">&quot;c3&quot;</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">3c(&amp;H[0-9A-Fa-f]</span><span class="si">{6}</span><span class="s2">&amp;)&quot;</span><span class="p">),</span>
        <span class="s2">&quot;c4&quot;</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">4c(&amp;H[0-9A-Fa-f]</span><span class="si">{6}</span><span class="s2">&amp;)&quot;</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Line</span><span class="p">],</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_changes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">required_colors</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;c1&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;c3&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;c4&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="c1"># Extract color information from a single subtitle line</span>
            <span class="n">tags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_PATTERNS</span><span class="p">[</span><span class="s2">&quot;tags&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">raw_text</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_process_static_colors</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_process_transform_colors</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_process_static_colors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process static color declarations outside of transforms.&quot;&quot;&quot;</span>
        <span class="n">static_content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_PATTERNS</span><span class="p">[</span><span class="s2">&quot;transform&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_colors</span><span class="p">(</span><span class="n">static_content</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">colors</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">color_changes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span>
                    <span class="s2">&quot;end&quot;</span><span class="p">:</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span>
                    <span class="s2">&quot;acc&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">colors</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_process_transform_colors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process color transformations within \\t tags.&quot;&quot;&quot;</span>
        <span class="n">transforms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_PATTERNS</span><span class="p">[</span><span class="s2">&quot;transform&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">start_str</span><span class="p">,</span> <span class="n">end_str</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">transforms</span><span class="p">:</span>
            <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_str</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">end_str</span><span class="p">)</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">acc</span><span class="p">,</span> <span class="n">color_content</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">acc</span><span class="p">,</span> <span class="n">color_content</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">continue</span>  <span class="c1"># Skip malformed transforms</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">continue</span>  <span class="c1"># Skip malformed transforms with too many parts</span>

            <span class="n">colors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_colors</span><span class="p">(</span><span class="n">color_content</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">colors</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                <span class="n">abs_start</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">start</span> <span class="o">+</span> <span class="n">offset</span>
                <span class="n">abs_end</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="n">end</span> <span class="o">+</span> <span class="n">offset</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">color_changes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">{</span><span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="n">abs_start</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">:</span> <span class="n">abs_end</span><span class="p">,</span> <span class="s2">&quot;acc&quot;</span><span class="p">:</span> <span class="n">acc</span><span class="p">,</span> <span class="o">**</span><span class="n">colors</span><span class="p">}</span>
                <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_extract_colors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract c1, c3, c4 colors from content string.&quot;&quot;&quot;</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">color_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;c1&quot;</span><span class="p">,</span> <span class="s2">&quot;c3&quot;</span><span class="p">,</span> <span class="s2">&quot;c4&quot;</span><span class="p">]:</span>
            <span class="n">match</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_PATTERNS</span><span class="p">[</span><span class="n">color_type</span><span class="p">]</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
            <span class="n">colors</span><span class="p">[</span><span class="n">color_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">match</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">required_colors</span><span class="p">[</span><span class="n">color_type</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">colors</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_base_colors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get base colors from line style reference.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">styleref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Line has no styleref&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;c1&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">1c</span><span class="si">{</span><span class="n">line</span><span class="o">.</span><span class="n">styleref</span><span class="o">.</span><span class="n">color1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;c3&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">3c</span><span class="si">{</span><span class="n">line</span><span class="o">.</span><span class="n">styleref</span><span class="o">.</span><span class="n">color3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;c4&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">4c</span><span class="si">{</span><span class="n">line</span><span class="o">.</span><span class="n">styleref</span><span class="o">.</span><span class="n">color4</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_resolve_color_flags</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">c1</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">c3</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">c4</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Resolve color flags using defaults if None.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;c1&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">required_colors</span><span class="p">[</span><span class="s2">&quot;c1&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">c1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">c1</span><span class="p">,</span>
            <span class="s2">&quot;c3&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">required_colors</span><span class="p">[</span><span class="s2">&quot;c3&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">c3</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">c3</span><span class="p">,</span>
            <span class="s2">&quot;c4&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">required_colors</span><span class="p">[</span><span class="s2">&quot;c4&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">c4</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">c4</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_color_change</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span>
        <span class="n">c1</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">c3</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">c4</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate color transformation tags for a subtitle line&#39;s time range.</span>

<span class="sd">        Returns interpolated color changes that occur within the line&#39;s time span,</span>
<span class="sd">        including base colors and transformation tags. Automatically inherits colors</span>
<span class="sd">        from previous lines when not explicitly overridden.</span>

<span class="sd">        Args:</span>
<span class="sd">            line: [`Line`][pyonfx.ass_core.Line] object containing timing and style information.</span>
<span class="sd">            c1: Include primary color changes. Auto-detected if None.</span>
<span class="sd">            c3: Include border color changes. Auto-detected if None.</span>
<span class="sd">            c4: Include shadow color changes. Auto-detected if None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: ASS-formatted color tags for the line (e.g., &quot;\\1c&amp;HFFFFFF&amp;\\t(100,200,\\1c&amp;H000000&amp;)&quot;).</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; line.start_time, line.end_time = 1000, 2000</span>
<span class="sd">            &gt;&gt;&gt; cu.get_color_change(line)</span>
<span class="sd">            &quot;\\1c&amp;HFFFFFF&amp;\\3c&amp;H000000&amp;\\t(500,1000,\\1c&amp;H000000&amp;\\3c&amp;HFFFFFF&amp;)&quot;</span>
<span class="sd">            &gt;&gt;&gt; cu.get_color_change(line, c1=True, c3=False, c4=False)</span>
<span class="sd">            &quot;\\1c&amp;HFFFFFF&amp;\\t(500,1000,\\1c&amp;H000000&amp;)&quot;</span>

<span class="sd">        See Also:</span>
<span class="sd">            [`get_fr_color_change`][pyonfx.utils.ColorUtility.get_fr_color_change] for frame-by-frame color values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_color_flags</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c3</span><span class="p">,</span> <span class="n">c4</span><span class="p">)</span>
        <span class="n">base_colors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_colors</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="n">current_colors</span> <span class="o">=</span> <span class="n">base_colors</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="c1"># Update base colors from previous changes and build transforms</span>
        <span class="k">for</span> <span class="n">change</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_changes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span><span class="p">:</span>
                <span class="c1"># Update inherited colors from completed changes</span>
                <span class="k">for</span> <span class="n">color_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;c1&quot;</span><span class="p">,</span> <span class="s2">&quot;c3&quot;</span><span class="p">,</span> <span class="s2">&quot;c4&quot;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">change</span><span class="p">[</span><span class="n">color_type</span><span class="p">]:</span>
                        <span class="n">current_colors</span><span class="p">[</span><span class="n">color_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">change</span><span class="p">[</span><span class="n">color_type</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">line</span><span class="o">.</span><span class="n">end_time</span><span class="p">:</span>
                <span class="c1"># Build transformation for overlapping changes</span>
                <span class="n">rel_start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span><span class="p">)</span>
                <span class="n">rel_end</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span><span class="p">)</span>

                <span class="n">transform</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">t(</span><span class="si">{</span><span class="n">rel_start</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">rel_end</span><span class="si">}</span><span class="s2">,&quot;</span>
                <span class="k">if</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;acc&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">transform</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">change</span><span class="p">[</span><span class="s2">&quot;acc&quot;</span><span class="p">])</span>

                <span class="k">for</span> <span class="n">color_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;c1&quot;</span><span class="p">,</span> <span class="s2">&quot;c3&quot;</span><span class="p">,</span> <span class="s2">&quot;c4&quot;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">flags</span><span class="p">[</span><span class="n">color_type</span><span class="p">]</span> <span class="ow">and</span> <span class="n">change</span><span class="p">[</span><span class="n">color_type</span><span class="p">]:</span>
                        <span class="n">transform</span> <span class="o">+=</span> <span class="n">change</span><span class="p">[</span><span class="n">color_type</span><span class="p">]</span>

                <span class="n">transform</span> <span class="o">+=</span> <span class="s2">&quot;)&quot;</span>

        <span class="c1"># Prepend base colors</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">color_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;c1&quot;</span><span class="p">,</span> <span class="s2">&quot;c3&quot;</span><span class="p">,</span> <span class="s2">&quot;c4&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">flags</span><span class="p">[</span><span class="n">color_type</span><span class="p">]:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">current_colors</span><span class="p">[</span><span class="n">color_type</span><span class="p">]</span> <span class="o">+</span> <span class="n">result</span>

        <span class="k">return</span> <span class="n">result</span> <span class="o">+</span> <span class="n">transform</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_fr_color_change</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span>
        <span class="n">c1</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">c3</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">c4</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get interpolated color values for a specific frame time.</span>

<span class="sd">        Returns the exact color values at line.start_time by interpolating between</span>
<span class="sd">        color transformations. Essential for frame-by-frame rendering where you need</span>
<span class="sd">        precise color values at specific moments.</span>

<span class="sd">        Args:</span>
<span class="sd">            line: [`Line`][pyonfx.ass_core.Line] object where start_time represents the current frame time.</span>
<span class="sd">            c1: Include primary color interpolation. Auto-detected if None.</span>
<span class="sd">            c3: Include border color interpolation. Auto-detected if None.</span>
<span class="sd">            c4: Include shadow color interpolation. Auto-detected if None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Interpolated ASS color tags for the exact frame time (e.g., &quot;\\1c&amp;H808080&amp;&quot;).</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; line.start_time = 1500  # Frame at 1.5 seconds</span>
<span class="sd">            &gt;&gt;&gt; cu.get_fr_color_change(line)</span>
<span class="sd">            &quot;\\1c&amp;H808080&amp;\\3c&amp;HFF0000&amp;&quot;</span>
<span class="sd">            &gt;&gt;&gt; cu.get_fr_color_change(line, c1=True, c3=False)</span>
<span class="sd">            &quot;\\1c&amp;H808080&amp;&quot;</span>

<span class="sd">        See Also:</span>
<span class="sd">            [`get_color_change`][pyonfx.utils.ColorUtility.get_color_change] for complete transformation sequences over time ranges.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_color_flags</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c3</span><span class="p">,</span> <span class="n">c4</span><span class="p">)</span>
        <span class="n">base_colors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_colors</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="n">current_time</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span>

        <span class="c1"># Find the latest applicable color change</span>
        <span class="n">latest_idx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">change</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color_changes</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">current_time</span> <span class="o">&gt;=</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]:</span>
                <span class="n">latest_idx</span> <span class="o">=</span> <span class="n">i</span>

        <span class="c1"># No color changes found - use style defaults</span>
        <span class="k">if</span> <span class="n">latest_idx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_colors</span><span class="p">[</span><span class="n">ct</span><span class="p">]</span> <span class="k">for</span> <span class="n">ct</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;c1&quot;</span><span class="p">,</span> <span class="s2">&quot;c3&quot;</span><span class="p">,</span> <span class="s2">&quot;c4&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">flags</span><span class="p">[</span><span class="n">ct</span><span class="p">])</span>

        <span class="n">change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_changes</span><span class="p">[</span><span class="n">latest_idx</span><span class="p">]</span>

        <span class="c1"># Past the end of transformation - use final values</span>
        <span class="k">if</span> <span class="n">current_time</span> <span class="o">&gt;=</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">color_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;c1&quot;</span><span class="p">,</span> <span class="s2">&quot;c3&quot;</span><span class="p">,</span> <span class="s2">&quot;c4&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">flags</span><span class="p">[</span><span class="n">color_type</span><span class="p">]</span> <span class="ow">and</span> <span class="n">change</span><span class="p">[</span><span class="n">color_type</span><span class="p">]:</span>
                    <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">change</span><span class="p">[</span><span class="n">color_type</span><span class="p">])</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>

        <span class="c1"># Interpolate within the transformation</span>
        <span class="n">progress</span> <span class="o">=</span> <span class="p">(</span><span class="n">current_time</span> <span class="o">-</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">change</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">])</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">color_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;c1&quot;</span><span class="p">,</span> <span class="s2">&quot;c3&quot;</span><span class="p">,</span> <span class="s2">&quot;c4&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">flags</span><span class="p">[</span><span class="n">color_type</span><span class="p">]</span> <span class="ow">and</span> <span class="n">change</span><span class="p">[</span><span class="n">color_type</span><span class="p">]):</span>
                <span class="k">continue</span>

            <span class="c1"># Determine start color for interpolation</span>
            <span class="k">if</span> <span class="n">latest_idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">start_color</span> <span class="o">=</span> <span class="n">base_colors</span><span class="p">[</span><span class="n">color_type</span><span class="p">][</span><span class="mi">3</span><span class="p">:]</span>  <span class="c1"># Remove \\Xc prefix</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">prev_change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_changes</span><span class="p">[</span><span class="n">latest_idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">start_color</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">prev_change</span><span class="p">[</span><span class="n">color_type</span><span class="p">][</span><span class="mi">3</span><span class="p">:]</span>
                    <span class="k">if</span> <span class="n">prev_change</span><span class="p">[</span><span class="n">color_type</span><span class="p">]</span>
                    <span class="k">else</span> <span class="n">base_colors</span><span class="p">[</span><span class="n">color_type</span><span class="p">][</span><span class="mi">3</span><span class="p">:]</span>
                <span class="p">)</span>

            <span class="n">end_color</span> <span class="o">=</span> <span class="n">change</span><span class="p">[</span><span class="n">color_type</span><span class="p">][</span><span class="mi">3</span><span class="p">:]</span>  <span class="c1"># Remove \\Xc prefix</span>

            <span class="n">interpolated</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span>
                <span class="n">progress</span><span class="p">,</span> <span class="n">start_color</span><span class="p">,</span> <span class="n">end_color</span><span class="p">,</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;acc&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="si">{</span><span class="n">color_type</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="si">}{</span><span class="n">interpolated</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pyonfx.utils.ColorUtility.get_color_change" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_color_change</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">c1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c3</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c4</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generate color transformation tags for a subtitle line's time range.</p>
<p>Returns interpolated color changes that occur within the line's time span,
including base colors and transformation tags. Automatically inherits colors
from previous lines when not explicitly overridden.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>line</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Line


  
      dataclass
   (pyonfx.ass_core.Line)" href="../ass_core/#pyonfx.ass_core.Line">Line</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><a class="autorefs autorefs-internal" title="Line


  
      dataclass
  " href="../ass_core/#pyonfx.ass_core.Line"><code>Line</code></a> object containing timing and style information.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c1</code>
            </td>
            <td>
                  <code><span title="bool">bool</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Include primary color changes. Auto-detected if None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c3</code>
            </td>
            <td>
                  <code><span title="bool">bool</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Include border color changes. Auto-detected if None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c4</code>
            </td>
            <td>
                  <code><span title="bool">bool</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Include shadow color changes. Auto-detected if None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ASS-formatted color tags for the line (e.g., "\1c&amp;HFFFFFF&amp;\t(100,200,\1c&amp;H000000&amp;)").</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">line</span><span class="o">.</span><span class="n">start_time</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">end_time</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">2000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cu</span><span class="o">.</span><span class="n">get_color_change</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="go">&quot;\1c&amp;HFFFFFF&amp;\3c&amp;H000000&amp;\t(500,1000,\1c&amp;H000000&amp;\3c&amp;HFFFFFF&amp;)&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cu</span><span class="o">.</span><span class="n">get_color_change</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">c1</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">c3</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">c4</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">&quot;\1c&amp;HFFFFFF&amp;\t(500,1000,\1c&amp;H000000&amp;)&quot;</span>
</code></pre></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <p><a class="autorefs autorefs-internal" title="get_fr_color_change(line, c1=None, c3=None, c4=None)" href="#pyonfx.utils.ColorUtility.get_fr_color_change"><code>get_fr_color_change</code></a> for frame-by-frame color values.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>pyonfx/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_color_change</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span>
    <span class="n">c1</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">c3</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">c4</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate color transformation tags for a subtitle line&#39;s time range.</span>

<span class="sd">    Returns interpolated color changes that occur within the line&#39;s time span,</span>
<span class="sd">    including base colors and transformation tags. Automatically inherits colors</span>
<span class="sd">    from previous lines when not explicitly overridden.</span>

<span class="sd">    Args:</span>
<span class="sd">        line: [`Line`][pyonfx.ass_core.Line] object containing timing and style information.</span>
<span class="sd">        c1: Include primary color changes. Auto-detected if None.</span>
<span class="sd">        c3: Include border color changes. Auto-detected if None.</span>
<span class="sd">        c4: Include shadow color changes. Auto-detected if None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: ASS-formatted color tags for the line (e.g., &quot;\\1c&amp;HFFFFFF&amp;\\t(100,200,\\1c&amp;H000000&amp;)&quot;).</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; line.start_time, line.end_time = 1000, 2000</span>
<span class="sd">        &gt;&gt;&gt; cu.get_color_change(line)</span>
<span class="sd">        &quot;\\1c&amp;HFFFFFF&amp;\\3c&amp;H000000&amp;\\t(500,1000,\\1c&amp;H000000&amp;\\3c&amp;HFFFFFF&amp;)&quot;</span>
<span class="sd">        &gt;&gt;&gt; cu.get_color_change(line, c1=True, c3=False, c4=False)</span>
<span class="sd">        &quot;\\1c&amp;HFFFFFF&amp;\\t(500,1000,\\1c&amp;H000000&amp;)&quot;</span>

<span class="sd">    See Also:</span>
<span class="sd">        [`get_fr_color_change`][pyonfx.utils.ColorUtility.get_fr_color_change] for frame-by-frame color values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_color_flags</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c3</span><span class="p">,</span> <span class="n">c4</span><span class="p">)</span>
    <span class="n">base_colors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_colors</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="n">current_colors</span> <span class="o">=</span> <span class="n">base_colors</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">transform</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="c1"># Update base colors from previous changes and build transforms</span>
    <span class="k">for</span> <span class="n">change</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_changes</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span><span class="p">:</span>
            <span class="c1"># Update inherited colors from completed changes</span>
            <span class="k">for</span> <span class="n">color_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;c1&quot;</span><span class="p">,</span> <span class="s2">&quot;c3&quot;</span><span class="p">,</span> <span class="s2">&quot;c4&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">change</span><span class="p">[</span><span class="n">color_type</span><span class="p">]:</span>
                    <span class="n">current_colors</span><span class="p">[</span><span class="n">color_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">change</span><span class="p">[</span><span class="n">color_type</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">line</span><span class="o">.</span><span class="n">end_time</span><span class="p">:</span>
            <span class="c1"># Build transformation for overlapping changes</span>
            <span class="n">rel_start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span><span class="p">)</span>
            <span class="n">rel_end</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span><span class="p">)</span>

            <span class="n">transform</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">t(</span><span class="si">{</span><span class="n">rel_start</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">rel_end</span><span class="si">}</span><span class="s2">,&quot;</span>
            <span class="k">if</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;acc&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">transform</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">change</span><span class="p">[</span><span class="s2">&quot;acc&quot;</span><span class="p">])</span>

            <span class="k">for</span> <span class="n">color_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;c1&quot;</span><span class="p">,</span> <span class="s2">&quot;c3&quot;</span><span class="p">,</span> <span class="s2">&quot;c4&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">flags</span><span class="p">[</span><span class="n">color_type</span><span class="p">]</span> <span class="ow">and</span> <span class="n">change</span><span class="p">[</span><span class="n">color_type</span><span class="p">]:</span>
                    <span class="n">transform</span> <span class="o">+=</span> <span class="n">change</span><span class="p">[</span><span class="n">color_type</span><span class="p">]</span>

            <span class="n">transform</span> <span class="o">+=</span> <span class="s2">&quot;)&quot;</span>

    <span class="c1"># Prepend base colors</span>
    <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">color_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;c1&quot;</span><span class="p">,</span> <span class="s2">&quot;c3&quot;</span><span class="p">,</span> <span class="s2">&quot;c4&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">flags</span><span class="p">[</span><span class="n">color_type</span><span class="p">]:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">current_colors</span><span class="p">[</span><span class="n">color_type</span><span class="p">]</span> <span class="o">+</span> <span class="n">result</span>

    <span class="k">return</span> <span class="n">result</span> <span class="o">+</span> <span class="n">transform</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pyonfx.utils.ColorUtility.get_fr_color_change" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_fr_color_change</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">c1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c3</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c4</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get interpolated color values for a specific frame time.</p>
<p>Returns the exact color values at line.start_time by interpolating between
color transformations. Essential for frame-by-frame rendering where you need
precise color values at specific moments.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>line</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Line


  
      dataclass
   (pyonfx.ass_core.Line)" href="../ass_core/#pyonfx.ass_core.Line">Line</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><a class="autorefs autorefs-internal" title="Line


  
      dataclass
  " href="../ass_core/#pyonfx.ass_core.Line"><code>Line</code></a> object where start_time represents the current frame time.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c1</code>
            </td>
            <td>
                  <code><span title="bool">bool</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Include primary color interpolation. Auto-detected if None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c3</code>
            </td>
            <td>
                  <code><span title="bool">bool</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Include border color interpolation. Auto-detected if None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c4</code>
            </td>
            <td>
                  <code><span title="bool">bool</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Include shadow color interpolation. Auto-detected if None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Interpolated ASS color tags for the exact frame time (e.g., "\1c&amp;H808080&amp;").</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">line</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="mi">1500</span>  <span class="c1"># Frame at 1.5 seconds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cu</span><span class="o">.</span><span class="n">get_fr_color_change</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="go">&quot;\1c&amp;H808080&amp;\3c&amp;HFF0000&amp;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cu</span><span class="o">.</span><span class="n">get_fr_color_change</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">c1</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">c3</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">&quot;\1c&amp;H808080&amp;&quot;</span>
</code></pre></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <p><a class="autorefs autorefs-internal" title="get_color_change(line, c1=None, c3=None, c4=None)" href="#pyonfx.utils.ColorUtility.get_color_change"><code>get_color_change</code></a> for complete transformation sequences over time ranges.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>pyonfx/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_fr_color_change</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">line</span><span class="p">:</span> <span class="n">Line</span><span class="p">,</span>
    <span class="n">c1</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">c3</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">c4</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get interpolated color values for a specific frame time.</span>

<span class="sd">    Returns the exact color values at line.start_time by interpolating between</span>
<span class="sd">    color transformations. Essential for frame-by-frame rendering where you need</span>
<span class="sd">    precise color values at specific moments.</span>

<span class="sd">    Args:</span>
<span class="sd">        line: [`Line`][pyonfx.ass_core.Line] object where start_time represents the current frame time.</span>
<span class="sd">        c1: Include primary color interpolation. Auto-detected if None.</span>
<span class="sd">        c3: Include border color interpolation. Auto-detected if None.</span>
<span class="sd">        c4: Include shadow color interpolation. Auto-detected if None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Interpolated ASS color tags for the exact frame time (e.g., &quot;\\1c&amp;H808080&amp;&quot;).</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; line.start_time = 1500  # Frame at 1.5 seconds</span>
<span class="sd">        &gt;&gt;&gt; cu.get_fr_color_change(line)</span>
<span class="sd">        &quot;\\1c&amp;H808080&amp;\\3c&amp;HFF0000&amp;&quot;</span>
<span class="sd">        &gt;&gt;&gt; cu.get_fr_color_change(line, c1=True, c3=False)</span>
<span class="sd">        &quot;\\1c&amp;H808080&amp;&quot;</span>

<span class="sd">    See Also:</span>
<span class="sd">        [`get_color_change`][pyonfx.utils.ColorUtility.get_color_change] for complete transformation sequences over time ranges.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_color_flags</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c3</span><span class="p">,</span> <span class="n">c4</span><span class="p">)</span>
    <span class="n">base_colors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_colors</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="n">current_time</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start_time</span>

    <span class="c1"># Find the latest applicable color change</span>
    <span class="n">latest_idx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">change</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color_changes</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">current_time</span> <span class="o">&gt;=</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]:</span>
            <span class="n">latest_idx</span> <span class="o">=</span> <span class="n">i</span>

    <span class="c1"># No color changes found - use style defaults</span>
    <span class="k">if</span> <span class="n">latest_idx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_colors</span><span class="p">[</span><span class="n">ct</span><span class="p">]</span> <span class="k">for</span> <span class="n">ct</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;c1&quot;</span><span class="p">,</span> <span class="s2">&quot;c3&quot;</span><span class="p">,</span> <span class="s2">&quot;c4&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">flags</span><span class="p">[</span><span class="n">ct</span><span class="p">])</span>

    <span class="n">change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_changes</span><span class="p">[</span><span class="n">latest_idx</span><span class="p">]</span>

    <span class="c1"># Past the end of transformation - use final values</span>
    <span class="k">if</span> <span class="n">current_time</span> <span class="o">&gt;=</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">color_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;c1&quot;</span><span class="p">,</span> <span class="s2">&quot;c3&quot;</span><span class="p">,</span> <span class="s2">&quot;c4&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">flags</span><span class="p">[</span><span class="n">color_type</span><span class="p">]</span> <span class="ow">and</span> <span class="n">change</span><span class="p">[</span><span class="n">color_type</span><span class="p">]:</span>
                <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">change</span><span class="p">[</span><span class="n">color_type</span><span class="p">])</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>

    <span class="c1"># Interpolate within the transformation</span>
    <span class="n">progress</span> <span class="o">=</span> <span class="p">(</span><span class="n">current_time</span> <span class="o">-</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">change</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">])</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">color_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;c1&quot;</span><span class="p">,</span> <span class="s2">&quot;c3&quot;</span><span class="p">,</span> <span class="s2">&quot;c4&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">flags</span><span class="p">[</span><span class="n">color_type</span><span class="p">]</span> <span class="ow">and</span> <span class="n">change</span><span class="p">[</span><span class="n">color_type</span><span class="p">]):</span>
            <span class="k">continue</span>

        <span class="c1"># Determine start color for interpolation</span>
        <span class="k">if</span> <span class="n">latest_idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">start_color</span> <span class="o">=</span> <span class="n">base_colors</span><span class="p">[</span><span class="n">color_type</span><span class="p">][</span><span class="mi">3</span><span class="p">:]</span>  <span class="c1"># Remove \\Xc prefix</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">prev_change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_changes</span><span class="p">[</span><span class="n">latest_idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">start_color</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">prev_change</span><span class="p">[</span><span class="n">color_type</span><span class="p">][</span><span class="mi">3</span><span class="p">:]</span>
                <span class="k">if</span> <span class="n">prev_change</span><span class="p">[</span><span class="n">color_type</span><span class="p">]</span>
                <span class="k">else</span> <span class="n">base_colors</span><span class="p">[</span><span class="n">color_type</span><span class="p">][</span><span class="mi">3</span><span class="p">:]</span>
            <span class="p">)</span>

        <span class="n">end_color</span> <span class="o">=</span> <span class="n">change</span><span class="p">[</span><span class="n">color_type</span><span class="p">][</span><span class="mi">3</span><span class="p">:]</span>  <span class="c1"># Remove \\Xc prefix</span>

        <span class="n">interpolated</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span>
            <span class="n">progress</span><span class="p">,</span> <span class="n">start_color</span><span class="p">,</span> <span class="n">end_color</span><span class="p">,</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;acc&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="si">{</span><span class="n">color_type</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="si">}{</span><span class="n">interpolated</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../shape/" class="md-footer__link md-footer__link--prev" aria-label="Previous: shape">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                shape
              </div>
            </div>
          </a>
        
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2019-2025 Antonio Strippoli (CoffeeStraw) and <a href="https://github.com/CoffeeStraw/PyonFX/graphs/contributors"><u>contributors</u></a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "navigation.footer", "content.footnote.tooltips", "content.code.copy"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.50899def.min.js"></script>
      
    
  </body>
</html>